/*
Copyright 2012, MT, v1.0.0, build time: Dec 6 10:30
*/
(function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(d,e){var b=[],f;e=e||a.length;if(d)for(f=0;f<d;f++)b[f]=a[0|Math.random()*e];else{var c;b[8]=b[13]=b[18]=b[23]="-";b[14]="4";for(f=0;f<36;f++)if(!b[f]){c=0|Math.random()*16;b[f]=a[f==19?c&3|8:c]}}return b.join("")};Math.uuidFast=function(){for(var d=Array(36),e=0,b,f=0;f<36;f++)if(f==8||f==13||f==18||f==23)d[f]="-";else if(f==14)d[f]="4";else{if(e<=2)e=33554432+Math.random()*16777216|0;
b=e&15;e>>=4;d[f]=a[f==19?b&3|8:b]}return d.join("")};Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var e=Math.random()*16|0;return(d=="x"?e:e&3|8).toString(16)})}})();(function(a){a.math={lerp:function(d,e,b){return d+b*(e-d)},uuid:function(d,e){return Math.uuid(d,e)},uuidFast:function(){return Math.uuidFast()},uuidCompact:function(){return Math.uuidCompact()}}})(MT);
MT.add("mt-math-box",function(a){function d(b,f,c,g){this.top=b;this.right=f;this.bottom=c;this.left=g}var e=d.prototype;e.clone=function(){return new d(this.top,this.right,this.bottom,this.left)};e.toString=function(){return"Box["+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l]"};e.contains=function(b){return d.contains(this,b)};d.contains=function(b,f){if(!b||!f)return false;if(f instanceof d)return f.left>=b.left&&f.right<=b.right&&f.top>=b.top&&f.bottom<=b.bottom;return f.x>=b.left&&
f.x<=b.right&&f.y>=b.top&&f.y<=b.bottom};e.expand=function(b,f,c,g){if(MT.isObject(b)){this.top-=b.top;this.right+=b.right;this.bottom+=b.bottom;this.left-=b.left}else{this.top-=b;this.right+=f;this.bottom+=c;this.left-=g}return this};d.equals=function(b,f){if(b==f)return true;if(!b||!f)return false;return b.top==f.top&&b.right==f.right&&b.bottom==f.bottom&&b.left==f.left};d.relativePositionX=function(b,f){if(f.x<b.left)return f.x-b.left;else if(f.x>b.right)return f.x-b.right;return 0};d.relativePositionY=
function(b,f){if(f.y<b.top)return f.y-b.top;else if(f.y>b.bottom)return f.y-b.bottom;return 0};d.distance=function(b,f){var c=MT.math.Box.relativePositionX(b,f),g=MT.math.Box.relativePositionY(b,f);return Math.sqrt(c*c+g*g)};d.intersects=function(b,f){return b.left<=f.right&&f.left<=b.right&&b.top<=f.bottom&&f.top<=b.bottom};d.intersectsWithPadding=function(b,f,c){return b.left<=f.right+c&&f.left<=b.right+c&&b.top<=f.bottom+c&&f.top<=b.bottom+c};e.translateBy=function(b,f){if(arguments.length==1){f=
b.y;b=b.x}this.top+=f;this.right+=b;this.bottom+=f;this.left+=b;return this};e.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};a.math.Box=d});
MT.add("mt-math-coordinate",function(){function a(e,b){this.x=MT.isUndefined(e)?0:e;this.y=MT.isUndefined(b)?0:b}var d=a.prototype;d.clone=function(){return new a(this.x,this.y)};d.toString=function(){return"OFFSET["+this.x+", "+this.y+"]"};a.equals=function(e,b){if(e==b)return true;if(!e||!b)return false;return e.x==b.x&&e.y==b.y};d.equals=function(e){return a.equals(this,e)};d.round=function(e){if(isNaN(e)){this.x=Math.round(this.x);this.y=Math.round(this.y)}else{e=Math.pow(10,e);this.x=Math.round(this.x*
e)/e;this.y=Math.round(this.y*e)/e}};d.isOrigin=function(){return this.x==0&&this.y==0};MT.math.Coordinate=a});
MT.add("mt-math-size",function(){function a(e,b){this.width=e;this.height=b}var d=a.prototype;a.equals=function(e,b){if(e==b)return true;if(!e||!b)return false;return e.width==b.width&&e.height==b.height};d.clone=function(){return new MT.math.Size(this.width,this.height)};d.toString=function(){return"("+this.width+" x "+this.height+")"};d.getLongest=function(){return Math.max(this.width,this.height)};d.getShortest=function(){return Math.min(this.width,this.height)};d.area=function(){return this.width*
this.height};d.perimeter=function(){return(this.width+this.height)*2};d.aspectRatio=function(){return this.width/this.height};d.isEmpty=function(){return!this.area()};d.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};d.fitsInside=function(e){return this.width<=e.width&&this.height<=e.height};d.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};d.round=function(){this.width=Math.round(this.width);this.height=
Math.round(this.height);return this};d.scale=function(e){this.width*=e;this.height*=e;return this};d.scaleToFit=function(e){return this.scale(this.aspectRatio()>e.aspectRatio()?e.width/this.width:e.height/this.height)};MT.math.Size=a});
MT.add("mt-math-rect",function(a){function d(b,f,c,g){this.left=b;this.top=f;this.width=c;this.height=g}var e=d.prototype;e.clone=function(){return new a.math.Rect(this.left,this.top,this.width,this.height)};e.toBox=function(){return new MT.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)};d.createFromBox=function(b){return new a.math.Rect(b.left,b.top,b.right-b.left,b.bottom-b.top)};e.toString=function(){return"RECT("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+
"h)"};d.equals=function(b,f){if(b==f)return true;if(!b||!f)return false;return b.left==f.left&&b.width==f.width&&b.top==f.top&&b.height==f.height};e.intersection=function(b){var f=Math.max(this.left,b.left),c=Math.min(this.left+this.width,b.left+b.width);if(f<=c){var g=Math.max(this.top,b.top);b=Math.min(this.top+this.height,b.top+b.height);if(g<=b){this.left=f;this.top=g;this.width=c-f;this.height=b-g;return true}}return false};d.intersection=function(b,f){var c=Math.max(b.left,f.left),g=Math.min(b.left+
b.width,f.left+f.width);if(c<=g){var h=Math.max(b.top,f.top),i=Math.min(b.top+b.height,f.top+f.height);if(h<=i)return new a.math.Rect(c,h,g-c,i-h)}return null};d.intersects=function(b,f){return b.left<=f.left+f.width&&f.left<=b.left+b.width&&b.top<=f.top+f.height&&f.top<=b.top+b.height};e.intersects=function(b){return d.intersects(this,b)};d.difference=function(b,f){var c=d.intersection(b,f);if(!c||!c.height||!c.width)return[b.clone()];c=[];var g=b.top,h=b.height,i=b.left+b.width,j=b.top+b.height,
k=f.left+f.width,l=f.top+f.height;if(f.top>b.top){c.push(new a.math.Rect(b.left,b.top,b.width,f.top-b.top));g=f.top;h-=f.top-b.top}if(l<j){c.push(new a.math.Rect(b.left,l,b.width,j-l));h=l-g}f.left>b.left&&c.push(new a.math.Rect(b.left,g,f.left-b.left,h));k<i&&c.push(new a.math.Rect(k,g,i-k,h));return c};e.difference=function(b){return d.difference(this,b)};e.boundingRect=function(b){var f=Math.max(this.left+this.width,b.left+b.width),c=Math.max(this.top+this.height,b.top+b.height);this.left=Math.min(this.left,
b.left);this.top=Math.min(this.top,b.top);this.width=f-this.left;this.height=c-this.top};d.boundingRect=function(b,f){if(!b||!f)return null;var c=b.clone();c.boundingRect(f);return c};e.contains=function(b){return b instanceof a.math.Rect?this.left<=b.left&&this.left+this.width>=b.left+b.width&&this.top<=b.top&&this.top+this.height>=b.top+b.height:b.x>=this.left&&b.x<=this.left+this.width&&b.y>=this.top&&b.y<=this.top+this.height};e.getSize=function(){return new MT.math.Size(this.width,this.height)};
MT.math.Rect=d});
MT.add("mt-functions",function(a){var d=Function.prototype,e=Array.prototype.slice;a.func={};a.func.setter=function(b){return function(f,c){var g=this;if(f===null)return g;typeof f!=="string"?MT.each(f,function(h,i){b.call(g,i,h)}):b.call(g,f,c);return g}};a.func.bind=function(b,f){if(!MT.isFunction(b))throw Error("illegal function input,@MT.func.bind");var c,g;if(d.bind&&b.bind===d.bind)return d.bind.apply(b,e.call(arguments,1));g=e.call(arguments,2);return c=function(){if(!(this instanceof c))return b.apply(f,
g.concat(e.call(arguments)));var h=function(){};h.prototype=b.prototype;h=new h;var i=b.apply(h,g.concat(e.call(arguments)));if(Object(i)===i)return i;return h}};a.func.delay=function(b,f,c){var g=e.call(arguments,3);return setTimeout(function(){return b.apply(c,g)},f)};a.func.defer=function(b){return this.delay.apply(this,[b,1].concat(e.call(arguments,1)))};a.func.once=function(b,f){var c=false,g;return function(){if(c)return g;c=true;return g=b.apply(f||a.global,arguments)}};a.func.throttle=function(b,
f,c){var g,h,i,j,k=function(){b.apply(c||a.global,i);g=(new Date).getTime()};return function(){h=(new Date).getTime()-g;i=arguments;clearTimeout(j);if(!g||h>=f)k();else j=setTimeout(k,f-h)}}});
MT.add("util-hashmap",function(a,d){function e(){this.clear()}a.namespace("util.HashMap");var b=e.prototype;b.add=function(f,c){if(arguments.length===1){c=f;f=this.getKey(f)}if(f===""||MT.isUndefined(f)||MT.isNull(f))return false;if(this.containsKey(f))return this.replace(f,c);this._map[f]=c;++this.length;return c};b.get=function(f){return this._map[f]};b.replace=function(f,c){return this._map[f]=c};b.getKey=function(f){return f.id};b.removeByKey=function(f){if(this.containsKey(f)){delete this._map[f];
--this.length;return true}return false};b.removeByValue=function(f){f=this.findKey(f);if(f!==d)return this.removeByKey(f);return false};b.containsKey=function(f){return this._map[f]!==d};b.containsValue=function(f){return this.containsKey(this.findKey(f))};b.findKey=function(f){var c,g=this._map;for(c in g)if(g.hasOwnProperty(c)&&g[c]===f)return c;return d};b.getSet_=function(f){var c,g=[],h=this._map;for(c in h)if(h.hasOwnProperty(c))g.push(f?c:h[c]);return g};b.getKeys=function(){return this.getSet_(true)};
b.getValues=function(){return this.getSet_(false)};b.size=function(){return this.length};b.isEmpty=function(){return this.length===0};b.clear=function(){this._map={};this.length=0;return this};a.util.HashMap=e});
MT.add("mt-event",function(a){a.events={};a.events.Event=function(d,e){if(!(this instanceof MT.events.Event))return new MT.events.Event(d,e);if(d&&d.type){this.originalEvent=d;this.type=d.type;this.isDefaultPrevented=d.defaultPrevented||d.returnValue===false||d.getPreventDefault&&d.getPreventDefault()?true:false}else this.type=d;e&&MT.mixin(this,e);this.timeStamp=d&&d.timeStamp||MT.now();this[MT.PROPERTY_+"qb"]=true};a.events.Event.prototype={preventDefault:function(){this.isDefaultPrevented=true;
var d=this.originalEvent;if(d)if(d.preventDefault)d.preventDefault();else d.returnValue=false},stopPropagation:function(){this.isPropagationStopped=true;var d=this.originalEvent;if(d){d.stopPropagation&&d.stopPropagation();d.cancelBubble=true}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=true;this.stopPropagation()},halt:function(d){d?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()},within:function(d,e,b){if(d){e=e?this.relatedTarget:this.target;
var f;if(e&&MT.dom){f=MT.getDom(d);d=MT.dom.contains(f,e);if(!d&&b)d=e==f;return d}}return false},isDefaultPrevented:false,isPropagationStopped:false,isImmediatePropagationStopped:false}});
MT.add("mt-event-events",function(a,d){var e=a.Config,b=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,f=function(c){if(c=b.exec(c)){c[1]=(c[1]||"").toLowerCase();c[3]=c[3]&&RegExp("(?:^|\\s)"+c[3]+"(?:\\s|$)")}return c};a.events.add_=function(c,g,h,i,j,k){if(!c||h.nodeType===3||h.nodeType===8||!i||h.nodeType!==1&&h.nodeType!==9&&h!==e.win)return d;var l,n,m=MT.isString(i)?i:i.type,o=m;if(k){k.origType_=o;k.quick_=j&&f(j)}n=MT.events.special[m]||{};m=(j?n.delegateType:n.bindType)||m;n=MT.events.special[m]||
{};if(m!=o){c.replaceSig_(i,m);i.type=m}l=c.eventHandle_;if(!l){c.eventHandle_=l=function(p){p=MT.events.fix(p||window.event);return MT.fire(l.elem,p.type,p)};l.elem=h}c=c.slots[g];if(!c||c.length==0)if(!n.setup||n.setup.call(h,k.prevParams,l)===false)a.events.addEvent_(h,m,l);n.add&&n.add.call(h,k);return true};a.events.remove_=function(c,g,h,i,j){if(!c||!g||!i||!h)return d;var k;k=MT.events.special[i]||{};i=(j?k.delegateType:k.bindType)||i;if(g.length===0)if(!k.teardown||k.teardown.call(h)===false){a.events.removeEvent_(h,
i,c.eventHandle_);c.eventHandle_=null}};a.events.addEvent_=a.Config.doc.addEventListener?function(c,g,h,i){c.addEventListener&&c.addEventListener(g,h,!!i)}:function(c,g,h){c.attachEvent&&c.attachEvent("on"+g,h)};a.events.removeEvent_=a.Config.doc.removeEventListener?function(c,g,h,i){c.removeEventListener&&c.removeEventListener(g,h,!!i)}:function(c,g,h){c.detachEvent&&c.detachEvent("on"+g,h)}});
MT.add("mt-event-fix",function(a,d){var e={fixHooks:{},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(c,g){if(c.which==null)c.which=g.charCode!=null?g.charCode:g.keyCode;return c}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY detail wheelDelta axis toElement".split(" "),
filter:function(c,g){var h,i,j=g.button,k=g.fromElement;if(c.pageX==null&&g.clientX!=null){h=c.target.ownerDocument||document;i=h.documentElement;h=h.body;c.pageX=g.clientX+(i&&i.scrollLeft||h&&h.scrollLeft||0)-(i&&i.clientLeft||h&&h.clientLeft||0);c.pageY=g.clientY+(i&&i.scrollTop||h&&h.scrollTop||0)-(i&&i.clientTop||h&&h.clientTop||0)}if(!c.relatedTarget&&k)c.relatedTarget=k===c.target?g.toElement:k;if(!c.which&&j!==d)c.which=j&1?1:j&2?3:j&4?2:0;return c}}},b=/^key/,f=/^(?:mouse|contextmenu)|click/;
a.mixin(a.events,e);a.events.fix=function(c){if(c[MT.PROPERTY_+"qb"])return c;var g,h,i=c,j=a.events.fixHooks[c.type]||{},k=j.props?this.props.concat(j.props):this.props;c=MT.events.Event(i);for(g=k.length;g;){h=k[--g];c[h]=i[h]}if(!c.target)c.target=i.srcElement||document;if(c.target.nodeType===3)c.target=c.target.parentNode;if(c.metaKey===d)c.metaKey=c.ctrlKey;return j.filter?j.filter(c,i):c};MT.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(c){if(b.test(c))a.events.fixHooks[c]=a.events.keyHooks;if(f.test(c))a.events.fixHooks[c]=a.events.mouseHooks})});MT.add("mt-event-special",function(a){a.events.special={focus:{delegateType:"focusin"},blur:{delegateType:"focusout"}}});
MT.add("mt-event-eventtarget",function(a){a.events.EventTarget=function(){a.Base.call(this)};a.inherits(a.events.EventTarget,a.Base);var d=a.events.EventTarget.prototype;d.on=function(e,b,f,c,g,h){var i=[],j=0;if(MT.isFunction(b)){h=g;g=c;c=f;f=b;b=null;f.once=h}if(MT.isArray(e))i=i.concat(e);else i.push(e);for(b=SLOT(f,c,b,g);e=i[j];j++)MT.on(this,SIGNAL(e),b);return this};d.off=function(e,b){var f=[],c,g=0;if(MT.isArray(e))f=f.concat(e);else f.push(e);for(;c=f[g];g++)c&&MT.off(this,SIGNAL(c),b);
return this};d.once=function(e,b,f,c,g){this.bind(e,b,f,c,g,true);return this};d.fire=function(e,b){return MT.fire(this,SIGNAL(e),b)};d.dispose=function(){MT.off(this)}});
MT.add("mt-event-mousewheel",function(a){function d(b){var f=0,c=0,g=0,h=this.data;b=MT.events.fix(b||window.event);if(b.type=="mousewheel"){c=1;if(MT.ua.ie||MT.ua.webkit&&(MT.ua.WIN||MT.ua.isVersion("532.0")))c=40;g=MT.events.special.mousewheel.smartScale_(-b.wheelDelta,c);if(MT.isUndefined(b.wheelDeltaX))c=g;else{f=a.events.special.mousewheel.smartScale_(-b.wheelDeltaX,c);c=a.events.special.mousewheel.smartScale_(-b.wheelDeltaY,c)}}else{g=b.detail;if(g>100)g=3;else if(g<-100)g=-3;if(!MT.isUndefined(b.axis)&&
b.axis===b.HORIZONTAL_AXIS)f=g;else c=g}if(h&&MT.isNumber(h.maxDeltaX_))f=a.number.clamp(f,-h.maxDeltaX_,h.maxDeltaX_);if(h&&MT.isNumber(h.maxDeltaY_))c=a.number.clamp(c,-h.maxDeltaY_,h.maxDeltaY_);MT.mixin(b,{deltaX:f,deltaY:c,detail:g,type:"mousewheel"});return MT.fire(this,SIGNAL("mousewheel"),b)}var e=MT.ua.gecko?"DOMMouseScroll":"mousewheel";a.events.special.mousewheel={setup:function(b){a.events.fixHooks[e]=a.events.mouseHooks;this.data=b;b=a.func.bind(d,this);a.events.addEvent_(this,e,b)},
teardown:function(){a.events.removeEvent_(this,e,d)},smartScale_:function(b,f){return MT.ua.webkit&&MT.ua.MAC&&b%f!=0?b:b/f}}});MT.add("mt-event-mouseenterleave",function(a){MT.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(d,e){a.events.special[e]={delegateType:d,bindType:d,handle:function(b){var f=b.relatedTarget,c;if(!f||f!==this&&!MT.dom.contains(this,f)){b.type=b.orgType;c=b.handleObj.callback.apply(this,arguments);b.type=d}return c}}})});
MT.add("mt-event-keycodes",function(a){a.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,
Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,
SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,PHANTOM:255}});
MT.add("mt-event-keyhandler",function(a){function d(f){a.events.EventTarget.call(this);this.init_(f||{})}var e,b=a.Config.doc;a.inherits(d,a.events.EventTarget);e=d.prototype;e.eventName="keydown";e.revname="keyup";e.keyCode=-1;e._set=a.func.setter(function(f,c){if(a.isFunction(this["_set"+a.string.capitalFirst(f)]))this["_set"+a.string.capitalFirst(f)](c);else this[f]=c});e.init_=function(f){if(!f.target)f.target=b;this._set(f);this._el=this.target.isComp||this.target.isButton?this.target.getNode():
a.get(this.target);this.bindings=[];this.keyCodeMap_={};this.map?this.attach(this.map):this.attach(f);this.enable()};e.attach=function(f){var c=f.key,g,h,i,j=[],k,l,n;if(a.isArray(f)){g=f.length;for(k=0;k<g;k++)this.attach(f[k])}else{if(a.isString(c))c=[c];g=c.length;for(k=0;k<g;++k){i=c[k];if(a.isString(i)){i=i.toUpperCase();h=i.length;for(l=0;l<h;++l){n=i.charCodeAt(l);j.push(n);this.keyCodeMap_[n]=true}}else{j.push(i);this.keyCodeMap_[i]=true}}j.length&&this.bindings.push(a.mixin({keyCode:j},f,
false))}};e.handleKeyDown_=function(f){var c=f.which;if(this.enabled&&this.keyCodeMap_[c]){c=this.bindings;var g,h=c.length;for(g=0;g<h;++g)this.doAction_(c[g],f)}};e.handleKeyUp_=function(f){var c=f.which;if(this.revFn)this.revFn.call(this.scope||this,c,f)};e.doAction_=function(f,c){var g=c.which,h=f.fn||f.handler,i=f.scope||this,j=f.keyCode,k,l;k=0;for(l=j.length;k<l;++k)if(g===j[k]){h.call(i,g,c);break}};e.enable=function(){if(!this.enabled){this._el.on(this.eventName,a.func.bind(this.handleKeyDown_,
this));this._el.on(this.revname,a.func.bind(this.handleKeyUp_,this));this.enabled=true}};e.disable=function(){if(this.enabled){this._el.off(this.eventName,a.func.bind(this.handleKeyDown_,this));this._el.off(this.revname,a.func.bind(this.handleKeyUp_,this));this.enabled=false}};e.destroy=function(){this.bindings=[];delete this.keyCodeMap_;this.disable();this._el=null;delete this.target};a.namespace("util.keyMap");a.util.keyMap=d});
MT.add("mt-template",function(a){var d={prefix:"__out__.push(",suffix:");"},e=Array.prototype.push,b=Array.prototype.join,f=a.string;Template=function(c,g){if(a.isEmpty(c)||a.isUndefined(c))throw Error("invalid tpl @ M.Template");var h="";if(a.isString(g))h=Template.cache_[g]||"";if(f.isEmpty(h)){h=Template.convert_(c);h=Template.build_(h);if(a.isString(g)&&!Template.cache_[g])Template.cache_[g]=h}var i=new Function("$data","MT",h);h=null;return{render:function(j,k){return i.call(k||a.global,j,MT)}}};
Template.convert_=function(c){var g=Template.statements["if"],h=Template.statements.each;if(a.isArray(c))c=c.join("");return c=c.replace(h.start,function(i,j,k,l){i=f.trim(l.replace(/,/g,""));return"<% MT.each("+j+", function("+k+", "+i+") { %>"}).replace(h.end,"<% }); %>").replace(g.start,function(i,j){return"<% if ("+j+") {%>"}).replace(Template.statements.elseif.start,function(i,j){return"<% } else if ("+j+") {%>"}).replace(Template.statements["else"].start,"<% } else {%>").replace(g.end,"<% } %>").replace(Template.statements.comment,
"").replace(Template.statements.encode,function(i,j){return"<%=MT.string.htmlEncode(Template.checkData_("+j+"))%>"}).replace(Template.statements.unencode,function(i,j){return"<%=Template.checkData_("+j+")%>"})};Template.build_=function(c){var g=[],h=/^=/;c=c.replace(/[\r\n\t]/igm," ").replace(/\\/gm,"\\\\").replace(/'/gm,"\\'").replace(/(.*?)<%(.*?)%>/ig,function(i,j,k){j!=""&&e.call(g,d.prefix+"'"+j+"'"+d.suffix);k=f.trim(k);if(k!="")h.test(k)?e.call(g,d.prefix+k.substr(1)+d.suffix):e.call(g,k);
return""});c!=""&&e.call(g,d.prefix+"'"+c+"'"+d.suffix);c=null;g=b.call(g,"");c=b.call(["try{var __out__=[];with($data){",g,'};return __out__.join("");}catch(e){MT.console(e.message);}'],"");g=null;return c};Template.cache_={};Template.checkData_=function(c){return a.isUndefined(c)?"":c};Template.statements={"if":{start:/{[\s\xa0]*#if[\s\xa0]*([^}]*?)[\s\xa0]*}/igm,end:/{[\s\xa0]*#\/if[\s\xa0]*}/igm},elseif:{start:/{[\s\xa0]*#elseif[\s\xa0]*([^}]*?)[\s\xa0]*}/igm},"else":{start:/{[\s\xa0]*#else[\s\xa0]*}/igm},
each:{start:/{[\s\xa0]*#each[\s\xa0]*([\w\.]*?)[\s\xa0]*as[\s\xa0]*(\w*?)([\s\xa0]*,[\s\xa0]*\w*?)?[\s\xa0]*}/igm,end:/{[\s\xa0]*#\/each[\s\xa0]*}/igm},encode:/\${[\s\xa0]*([\s\S]+?)[\s\xa0]*}/igm,unencode:/\$\*{[\s\xa0]*([\s\S]+?)[\s\xa0]*}/igm,comment:/{[\s\xa0]*--[^}]*?[\s\xa0]*}/igm};a.Template=Template});
(function(a){var d={},e={};a.manageAjax=function(){return{create:function(b,f){d[b]=new a.manageAjax._manager(b,f);return d[b]},destroy:function(b){if(d[b]){d[b].clear(true);delete d[b]}}}}();a.manageAjax._manager=function(b,f){this.requests={};this.inProgress=0;this.qName=this.name=b;this.opts=a.extend({},a.manageAjax.defaults,f);if(f&&f.queue&&f.queue!==true&&typeof f.queue==="string"&&f.queue!=="clear")this.qName=f.queue};a.manageAjax._manager.prototype={add:function(b,f){if(typeof b=="object")f=
b;else if(typeof b=="string")f=a.extend(f||{},{url:b});f=a.extend({},this.opts,f);var c=f.complete||a.noop,g=f.success||a.noop,h=f.beforeSend||a.noop,i=f.error||a.noop,j=typeof f.data=="string"?f.data:a.param(f.data||{}),k=f.type+f.url+j,l=this,n=this._createAjax(k,f,g,c);if(f.preventDoubleRequests&&f.queueDuplicateRequests){if(f.preventDoubleRequests)f.queueDuplicateRequests=false;setTimeout(function(){throw"preventDoubleRequests and queueDuplicateRequests can't be both true";},0)}if(!(this.requests[k]&&
f.preventDoubleRequests)){n.xhrID=k;f.xhrID=k;f.beforeSend=function(m,o){var p=h.call(this,m,o);p===false&&l._removeXHR(k);return p};f.complete=function(m,o){l._complete.call(l,this,c,m,o,k,f)};f.success=function(m,o,p){l._success.call(l,this,g,m,o,p,f)};f.error=function(m,o,p){var r="",q="";if(o!=="timeout"&&m){r=m.status;q=m.responseXML||m.responseText}i?i.call(this,m,o,p,f):setTimeout(function(){throw o+"| status: "+r+" | URL: "+f.url+" | data: "+j+" | thrown: "+p+" | response: "+q;},0);m=null};
f.queue==="clear"&&a(document).clearQueue(this.qName);if(f.queue||f.queueDuplicateRequests&&this.requests[k]){a.queue(document,this.qName,n);if(this.inProgress<f.maxRequests&&(!this.requests[k]||!f.queueDuplicateRequests))a.dequeue(document,this.qName);return k}return n()}},_createAjax:function(b,f,c,g){var h=this;return function(){if(f.beforeCreate.call(f.context||h,b,f)!==false){h.inProgress++;h.inProgress===1&&a.event.trigger(h.name+"AjaxStart");if(f.cacheResponse&&e[b])if(!e[b].cacheTTL||e[b].cacheTTL<
0||(new Date).getTime()-e[b].timestamp<e[b].cacheTTL){h.requests[b]={};setTimeout(function(){h._success.call(h,f.context||f,c,e[b]._successData,"success",e[b],f);h._complete.call(h,f.context||f,g,e[b],"success",b,f)},0)}else delete e[b];if(!f.cacheResponse||!e[b])if(f.async)h.requests[b]=a.ajax(f);else a.ajax(f);return b}}},_removeXHR:function(b){if(this.opts.queue||this.opts.queueDuplicateRequests)a.dequeue(document,this.qName);this.inProgress--;this.requests[b]=null;delete this.requests[b]},clearCache:function(){e=
{}},_isAbort:function(b,f,c){if(!c.abortIsNoSuccess||!b&&!f)return false;return!!(!b||b.readyState===0||this.lastAbort===c.xhrID)},_complete:function(b,f,c,g,h,i){if(this._isAbort(c,g,i)){g="abort";i.abort.call(b,c,g,i)}f.call(b,c,g,i);a.event.trigger(this.name+"AjaxComplete",[c,g,i]);i.domCompleteTrigger&&a(i.domCompleteTrigger).trigger(this.name+"DOMComplete",[c,g,i]).trigger("DOMComplete",[c,g,i]);this._removeXHR(h);this.inProgress||a.event.trigger(this.name+"AjaxStop")},_success:function(b,f,
c,g,h,i){var j=this;if(!this._isAbort(h,g,i)){i.abortOld&&a.each(this.requests,function(m){if(m===i.xhrID)return false;j.abort(m)});if(i.cacheResponse&&!e[i.xhrID]){h||(h={});e[i.xhrID]={status:h.status,statusText:h.statusText,responseText:h.responseText,responseXML:h.responseXML,_successData:c,cacheTTL:i.cacheTTL,timestamp:(new Date).getTime()};if("getAllResponseHeaders"in h){var k=h.getAllResponseHeaders(),l,n=function(){if(!l){l={};a.each(k.split("\n"),function(m,o){var p=o.indexOf(":");l[o.substr(0,
p)]=o.substr(p+2)})}};a.extend(e[i.xhrID],{getAllResponseHeaders:function(){return k},getResponseHeader:function(m){n();return m in l?l[m]:null}})}}f.call(b,c,g,h,i);a.event.trigger(this.name+"AjaxSuccess",[h,i,c]);i.domSuccessTrigger&&a(i.domSuccessTrigger).trigger(this.name+"DOMSuccess",[c,i]).trigger("DOMSuccess",[c,i])}h=null},getData:function(b){if(b){var f=this.requests[b];if(!f&&this.opts.queue)f=a.grep(a(document).queue(this.qName),function(c){return c.xhrID===b})[0];return f}return{requests:this.requests,
queue:this.opts.queue?a(document).queue(this.qName):[],inProgress:this.inProgress}},abort:function(b){var f;if(b){if((f=this.getData(b))&&f.abort){this.lastAbort=b;f.abort();this.lastAbort=false}else a(document).queue(this.qName,a.grep(a(document).queue(this.qName),function(h){return h!==f}));f=null}else{var c=this,g=[];a.each(this.requests,function(h){g.push(h)});a.each(g,function(h,i){c.abort(i)})}},clear:function(b){a(document).clearQueue(this.qName);b&&this.abort()}};a.manageAjax._manager.prototype.getXHR=
a.manageAjax._manager.prototype.getData;a.manageAjax.defaults={beforeCreate:a.noop,abort:a.noop,abortIsNoSuccess:true,maxRequests:1,cacheResponse:false,async:true,domCompleteTrigger:false,domSuccessTrigger:false,preventDoubleRequests:false,queueDuplicateRequests:false,cacheTTL:-1,queue:false};a.each(a.manageAjax._manager.prototype,function(b,f){b.indexOf("_")===0||!a.isFunction(f)||(a.manageAjax[b]=function(c,g){if(!d[c])if(b==="add")a.manageAjax.create(c,g);else return;var h=Array.prototype.slice.call(arguments,
1);d[c][b].apply(d[c],h)})});MT.ajax=a.ajax;MT.ajaxQ=a.manageAjax})(jQuery);
MT.add("mt-style",function(a){a.namespace("style");a.style={cssSizestoObject:function(d){d=d.split(" ");switch(d.length){case 1:d[1]=d[2]=d[3]=d[0];break;case 2:d[2]=d[0];d[3]=d[1];break;case 3:d[3]=d[1]}return{top:parseInt(d[0],10),right:parseInt(d[1],10),bottom:parseInt(d[2],10),left:parseInt(d[3],10)}},addCssRule:function(d,e,b){var f=document.styleSheets[document.styleSheets.length-1];if(b<0||a.isEmpty(b))b=(f.rules||f.cssRules).length;f.cssRules?f.insertRule(d+"{"+e+"}",b):f.addRule(d,e,b)}}});
MT.add("mt-support",function(a){a.support={cssFloat:!MT.ua.ie,boxModel:a.Config.isStrict,css3Transition:false}});
MT.add("mt-dom",function(a,d){var e=a.Config,b=e.win,f=e.doc,c=Array.prototype.slice,g=a.Element;e=g.prototype;var h=/^https/i.test(b.location.protocol);if(MT.isUndefined(jQuery))throw Error("need jQuery!");a.mixin(a,{cssPrefix:"mt-",BLANK_IMAGE_URL:a.ua.ie6||a.ua.ie&&a.ua.isVersion("7")?a.Config.basePath+"/resources/images/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",ifrmSrc:h&&MT.ua.ie?"javascript:''":"about:blank",get:function(i){if(!i)return null;
if(i instanceof MT.Element)return i;else if(MT.isString(i)||i.tagName||i==f||i==b){i=this.getDom(i);return i=MT.Element.meta(i)}else if(i.isComp)return i.getNode();return null},getDom:function(i){var j=/^[.|#]/;if(!i||!f)return null;return i.tag?i.tag:MT.isString(i)?j.test(i)?a.q(i).get(0):f.getElementById(i):i instanceof a.q?i[0]:i},getCmp:function(i){return MT.CompMgr.get(i)},removeNode:function(i){if(typeof jQuery!="undefined")this.q(i.tag?i.tag:i).remove();i.dd&&i.dd.dispose();i.drop&&i.drop.dispose();
this.get(i).dispose()},q:jQuery});a.dom={contains:function(i,j){return MT.q.contains(i,j)},NodeType:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},isElementNode:function(i){return!!(i&&i.nodeType===1)},isWindow:function(i){return i!=null&&i==i.window},getOwnerDocument:function(i){return i.nodeType==MT.dom.NodeType.DOCUMENT?i:i.ownerDocument||i.document},getFrameContentDoc:function(i){return i.contentDocument||
i.contentWindow.document},getFrameContentWindow:function(i){return i.contentWindow||MT.dom.getWindow(MT.dom.getFrameContentDoc(i))},getDoc:function(){var i;return function(){return i||(i=MT.get(f))}}(),getBody:function(){var i;return function(){return i||(i=MT.get(f.body))}}(),getWindow:function(i){return MT.dom.isWindow(i)?i:i.nodeType===MT.dom.NodeType.DOCUMENT?i.defaultView||i.parentWindow:false},getScrollbarWidth:function(){var i=this.getDocument(),j=i.createElement("div"),k;j.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";
k=i.createElement("div");MT.q(k).width(200).height(200);j.appendChild(k);i.body.appendChild(j);i=j.offsetWidth-j.clientWidth;MT.q(j).remove();return i},create:function(i,j){j=j||a.dom.getDocument();return a.get(a.q(i,j)[0])}};g.VISIBILITY=1;g.DISPLAY=2;g.OFFSET=3;g.data=function(i,j,k){i=MT.get(i);if(!i)return null;var l=MT.cache[i.key].data;if(!l)l=MT.cache[i.key].data={};return arguments.length==2?l[j]:l[j]=k};e.getCache=function(){var i=MT.getUid(this.tag),j;j=MT.cache[i]||(MT.cache[i]={data:{}});
if(MT.isUndefined(j.data))j.data=MT.cache[i].data={};return j};e.addClass=function(){MT.q(this.tag).addClass(c.call(arguments).join(" "));return this};e.removeClass=function(){MT.q(this.tag).removeClass(c.call(arguments).join(" "));return this};e.set=function(i,j){var k=this,l=k.tag;MT.each(i,function(n,m){if(m==="style")k.setStyle(n);else if(m==="class")l.className=n;else if(j!==false)n===d?l.removeAttribute(m):l.setAttribute(m,n);else l[m]=n});return this};e.getAttr=function(i,j){var k=this.tag;
return k.getAttributeNS(j,i)||k.getAttribute(j+":"+i)||k.getAttribute(i)||k[i]};e.contains=function(i){if(!i)return false;i=i.tag||i;var j=this.tag;return i===j||MT.dom.contains(j,i)};e.setHtml=function(i){var j=this.tag;if(j)j.innerHTML=i;return this};e.getHtml=function(){return this.tag?this.tag.innerHTML:""};e.show=function(){this.setVisible_(true);return this};e.hide=function(){this.setVisible_(false);return this};e.setVisible_=function(i){var j=this.getDisplayMode(),k=MT.cssPrefix;switch(j){case MT.Element.VISIBILITY:this.removeClass(k+
"hidden-display",k+"hidden-offset");this[i?"removeClass":"addClass"](k+"hidden-visibility");break;case MT.Element.DISPLAY:this.removeClass(k+"hidden-visibility",k+"hidden-offset");this[i?"removeClass":"addClass"](k+"hidden-display");break;case MT.Element.OFFSET:this.removeClass(k+"hidden-visibility",k+"hidden-display");this[i?"removeClass":"addClass"](k+"hidden-offset")}return this};e.getDisplayMode=function(){var i=this.getCache().data,j=i.displayMode;if(j===d)i.displayMode=j=MT.Element.DISPLAY;
return j};e.setDisplayMode=function(i){this.getCache().data.displayMode=i;return this};e.on=function(i,j,k,l,n,m){if(k==null&&l==null){l=j;k=j=d}else if(l==null)if(typeof j==="string"){l=k;k=d}else{l=k;k=j;j=d}if(!l)return this;l.once=m;MT.on(this.tag,i,j,SLOT(l,n,k));return this};e.off=function(i,j,k,l){if(j===false||typeof j==="function"){k=j;j=d}k=k?SLOT(k,l):null;this.removeSlot(SIGNAL(i),j,k);return this};e.once=function(i,j,k,l,n){this.on(i,j,k,l,n,true);return this};e.fire=function(i,j){this.dispatch(SIGNAL(i),
j);return this};e.hover=function(i,j,k){var l=a.func;k=k||this;this.on("mouseenter",l.bind(i,k));this.on("mouseleave",l.bind(j||i,k))};e.focus=function(){try{this.tag.focus();this.fire("focus",this)}catch(i){}return this};e.blur=function(){try{this.tag.blur();this.fire("blur",this)}catch(i){}return this};e.remove=function(){MT.removeNode(this)};e.load=function(i){this.getLoader(i?i.queueOptions:d).load(i);return this};e.getLoader=function(i){var j=g.data(this,"loader");if(!j){j=new MT.ElemLoader(a.mixin({target:this},
i||{}));g.data(this,"loader",j)}return j};e.monitorMouseLeave=function(i,j,k){var l=this,n,m={mouseleave:function(o){n=setTimeout(MT.func.bind(i,k||l,o),j)},mouseenter:function(){clearTimeout(n)}};l.on("mouseenter",m.mouseenter);l.on("mouseleave",m.mouseleave);return m};e.unMonMouseEnLv=function(i){var j;i=i||{};for(j in i)this.off(j,i[j])}});
MT.add("mt-dom-static",function(a,d){var e=a.Config,b=e.win,f=e.doc;a.mixin(a.dom,{getViewportWidth:function(c){c=c||b;return MT.q(c).width()},getViewportHeight:function(c){c=c||b;return MT.q(c).height()},getViewSize:function(c){var g=MT.dom.getViewportWidth(c);c=MT.dom.getViewportHeight(c);return new MT.math.Size(g,c)},getDocumentWidth:function(c){c=c||f;return Math.max(MT.q(c).width(),MT.dom.getViewportWidth(MT.dom.getWindow(c)))},getDocumentHeight:function(c){c=c||f;return Math.max(MT.q(c).height(),
MT.dom.getViewportHeight(MT.dom.getWindow(c)))},swapPosition:function(c,g){c=a.get(c);g=a.get(g);var h=c.getXY(),i=g.getXY();c.setXY(i);g.setXY(h);return c},swapNode:function(c,g){c=a.get(c);g=a.get(g);var h=g.tag.parentNode,i=g.tag.nextSibling;if(i==c)h.insertBefore(c,g);else if(g==c.tag.nextSibling)h.insertBefore(g,c);else{c.tag.parentNode.replaceChild(g,c);h.insertBefore(c,i)}return c},addUnits:function(c,g){if(MT.isNumber(c))return c+(g||"px");if(c===""||c=="auto"||c===d||c===null)return c||"";
return c},applyMarkup:function(c){var g,h,i=/tag|html|tpl|tplData$/i,j=c.tpl,k=c.html,l=c.tplData;h=c.tag||"<div></div>";for(g in c)c.hasOwnProperty(g)&&i.test(g)&&delete c[g];h=a.q(h,c);if(j){if(a.isString(j))j=a.Template(j);j=j.render(l);h.append(j)}k&&h.append(j);return h.get(0)}},true)});
MT.add("mt-dom-style",function(a,d){var e=function(g){var h=a.Element.data(g,"originalDisplay");if(h===d)a.Element.data(g,"originalDisplay",h="");return h},b={l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},f={l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},c={l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"};a.mixin(a.dom,{setStyle:function(g,h){if(MT.isString(h)){h=MT.string.trim(h).split(/\s*(?::|;)\s*/);for(var i=
0,j=h.length;i<j;)g.style[MT.string.toCamelCase(h[i++])]=h[i++]||""}else MT.isObject(h)&&MT.q(g).css(h);return this},getStyle:function(g,h){return MT.q(g).css(h)},setUnselectable:function(g,h){var i=MT.getDom(g);if(MT.ua.gecko||MT.ua.webkit)i.style[name]=h?"none":"";else if(MT.ua.ie||MT.ua.opera)i.setAttribute("unselectable",h?"on":"");if(h)MT.on(g,"selectstart",function(){return false});else MT.off(g,"selectstart")},setOpacity:function(g,h){var i=a.getDom(g).style;if("opacity"in i)i.opacity=h;else if("MozOpacity"in
i)i.MozOpacity=h;else if("filter"in i)i.filter=h===""?"":"alpha(opacity="+h*100+")"},setInlineBlock:function(g){g=MT.getDom(g).style;g.position="relative";if(MT.ua.ie&&!MT.ua.isVersion("8")){g.zoom="1";g.display="inline"}else g.display=MT.ua.gecko?MT.ua.isVersion("1.9a")?"inline-block":"-moz-inline-box":"inline-block"},fixedIE6Pos:function(){if(a.ua.ie6&&a.style){a.dom.getBody().setStyle({height:"100%",overflow:"auto"});a.style.addCssRule("*html","overflow-x:auto;overflow-y:hidden;")}},fixedElemPos:function(g){a.getDom(g).style.position=
a.ua.ie6?"absolute":"fixed"}});a.mixin(a.Element.prototype,{setStyle:function(g){MT.dom.setStyle(this.tag,g);return this},getStyle:function(g){return MT.dom.getStyle(this.tag,g)},isStyle:function(g,h){return this.getStyle(g)==h},hasClass:function(g){return MT.q(this.tag).hasClass(g)},toggleCls:function(g,h){MT.q(this.tag).toggleClass(g,h);return this},width:function(g){var h=MT.q(this.tag);if(g){h.width(g);return this}return h.width()},height:function(g){var h=MT.q(this.tag);if(g){h.height(g);return this}return h.height()},
innerWidth:function(){return MT.q(this.tag).innerWidth()},innerHeight:function(){return MT.q(this.tag).innerHeight()},outerWidth:function(g){return MT.q(this.tag).outerWidth(g||false)},outerHeight:function(g){return MT.q(this.tag).outerHeight(g||false)},setWidth:function(g,h){if(!h||!this.anim)this.width(g);else{a.isPlainObject(h)||(h={});this.animate(a.mixin({to:{width:g}},h,false))}return this},setHeight:function(g,h){if(!h||!this.anim)this.height(g);else{a.isPlainObject(h)||(h={});this.animate(a.mixin({to:{height:g}},
h,false))}return this},setSize:function(g,h,i){if(g instanceof MT.math.Size||MT.isObject(g)){h=g.height;g=g.width}if(!i||!this.anim){this.width(g);this.height(h)}else{a.isPlainObject(i)||(i={});this.animate(a.mixin({to:{width:g,height:h}},i,false))}return this},getSize:function(g){var h;g=g||0;if(g==0){g=this.width();h=this.height()}else if(g==1){g=this.innerWidth();h=this.innerHeight()}else{g=this.outerWidth();h=this.outerHeight()}return new MT.math.Size(g,h)},getViewSize:function(){var g=document,
h=this.tag;return h==g||h==g.body?{width:MT.dom.getViewportWidth(),height:MT.dom.getViewportHeight()}:{width:h.clientWidth,height:h.clientHeight}},setOpacity:function(g){MT.dom.setOpacity(this.tag,g);return this},setUnselectable:function(g){MT.dom.setUnselectable(this.tag,g);return this},getColor:function(g,h,i){g=this.getStyle(g);var j=i||i===""?i:"#",k;if(!g||/transparent|inherit/.test(g))return h;if(/^r/.test(g))a.each(g.slice(4,g.length-1).split(","),function(l){k=parseInt(l,10);j+=(k<16?"0":
"")+k.toString(16)});else{g=g.replace("#","");j+=g.length==3?g.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):g}return j.length>5?j.toLowerCase():h},setDisplayed:function(g){if(typeof g=="boolean")g=g?e(this.tag):"none";this.setStyle("display:"+g);return this},fixDisplay:function(){if(this.isStyle("display","none")){this.setStyle("visibility","hidden");this.setStyle("display",e(this.tag));this.isStyle("display","none")&&this.setStyle("display:block")}},addStyles:function(g,h){var i=0,j=(g||"").match(/\w/g),
k,l=j.length,n;if(l==1)i=Math.abs(parseFloat(this.getStyle(h[j[0]]))||0);else if(l)for(k=0;k<l;k++){n=j[k];i+=Math.abs(parseFloat(this.getStyle(h[n]))||0)}return i},getPadding:function(g){return this.addStyles(g,f)},getBorderWidth:function(g){return this.addStyles(g,b)},getMargin:function(g){return this.addStyles(g,c)}})});
MT.add("mt-dom-position",function(a){a.mixin(a.dom,{getXY:function(d){d=MT.getDom(d);var e;if(d.nodeType===MT.dom.NodeType.DOCUMENT)d=e=0;else{d=MT.q(d).offset();e=d.top;d=d.left}return new MT.math.Coordinate(d,e)},getX:function(d){return MT.dom.getXY(d).x},getY:function(d){return MT.dom.getXY(d).y},getOffsetsTo:function(d,e){var b=MT.dom.getXY(e),f=MT.dom.getXY(d);return[f.x-b.x,f.y-b.y]},setXY:function(d,e,b){var f=MT.getDom(d),c;if(!MT.isFunction(e)){if(a.isObject(e)){c=e.x||e.left;e=e.y||e.top;
if(b&&(a.isBoolean(b)||a.isObject(b))){var g={};if(anim&&d.anim){a.isPlainObject(b)||(b={});if(c)g.left=c;if(e)g.top=e;d.animate(a.mixin({to:g},b));return this}}}else{c=e;e=b}e={left:c,top:e};MT.q(f).offset(e)}return this},setX:function(d,e){return MT.dom.setXY(d,e,MT.dom.getY(d))},setY:function(d,e){return MT.dom.setXY(d,MT.dom.getX(d),e)}},true);a.mixin(a.Element.prototype,{getXY:function(){return MT.dom.getXY(this)},getX:function(){return this.getXY().x},getY:function(){return this.getXY().y},
getOffsetsTo:function(d){return MT.dom.getOffsetsTo(this,d)},getLeft:function(){return parseInt(this.getStyle("left"),10)||0},getTop:function(){return parseInt(this.getStyle("top"),10)||0},getRight:function(){return this.getX()+this.outerWidth()},getBottom:function(){return this.getY()+this.outerHeight()},position:function(){return MT.q(this.tag).position()},setXY:function(d,e){MT.dom.setXY(this,d,e);return this},setX:function(d,e){this.setXY(d,this.getY(),e);return this},setY:function(d,e){this.setXY(this.getX(),
d,e);return this},setLeftTop:function(d,e){var b=this.tag.style;b.left=a.dom.addUnits(d);b.top=a.dom.addUnits(e);return this},getBox:function(){var d=this.getXY(),e=this.getRight(),b=this.getBottom();return new MT.math.Box(d.y,e,b,d.x)},setBox:function(d,e){var b=d.width||d.right-d.left,f=d.height||d.bottom-d.top;this.setXY(d.left,d.top,e);this.setSize(b,f,e);return this},getBound:function(d){d=d||2;var e=this.getXY();d=this.getSize(d);return new MT.math.Rect(e.x,e.y,d.width,d.height)},getRegion:function(){return this.tag==
MT.dom.getBody().tag?this.getViewPortRegion():this.getBox()},getViewPortRegion:function(d){d=d||a.Config.docEl;var e=false,b=a.dom.getWindow(this.tag);b=a.dom.getViewSize(b);if(d){d=a.get(d).getScroll();e=new a.math.Box(d.top,b.width+d.left,d.top+b.height,d.left)}return e},inRegion:function(d,e,b){var f={};if(b&&!(b instanceof a.math.Box))b=new a.math.Box(b.top,b.right,b.bottom,b.left);b=b||this.getBox();if(d.tagName||d instanceof a.Element)f=a.get(d).getBox();else if(a.isObject(d))f=d instanceof
a.math.Box?d:new a.math.Box(d.top,d.right,d.bottom,d.left);else return false;return e?f.contains(b):MT.math.Box.intersects(f,b)},inViewportRegion:function(d,e){return this.inRegion(this.getViewPortRegion(),d,e)},intersect:function(d,e){var b=e||this.getBox(),f={};if(d.tagName||d instanceof a.Element)f=a.get(d).getBox();else if(a.isObject(d))f=d;else return false;b={left:Math.max(f.left,b.left),right:Math.min(f.right,b.right),top:Math.max(f.top,b.top),bottom:Math.min(f.bottom,b.bottom)};return{top:b.top,
right:b.right,bottom:b.bottom,left:b.left,area:(b.bottom-b.top)*(b.right-b.left),yoff:b.bottom-b.top,xoff:b.right-b.left,inRegion:this.inRegion(d,false,e)}},clearPositioning:function(d){d=d||"";this.setStyle({left:d,right:d,top:d,bottom:d,"z-index":"",position:"static"});return this},getPositioning:function(){var d=this.getStyle("left"),e=this.getStyle("top");return{position:this.getStyle("position"),left:d,right:d?"":this.getStyle("right"),top:e,bottom:e?"":this.getStyle("bottom"),"z-index":this.getStyle("z-index")}},
setPositioning:function(d){var e=this.tag.style;this.setStyle(d);if(d.right=="auto")e.right="";if(d.bottom=="auto")e.bottom="";return this}},true)});
MT.add("mt-dom-scroll",function(a){a.mixin(a.Element.prototype,{isScrollable:function(){var d=this.tag;return d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth},getScroll:function(){var d=this.tag,e=MT.dom.getDoc().tag,b=e.body,f=e.documentElement;if(d==e||d==b){if(MT.ua.ie&&MT.support.boxModel){e=f.scrollLeft;d=f.scrollTop}else{e=window.pageXOffset;d=window.pageYOffset}e=e||(b?b.scrollLeft:0);d=d||(b?b.scrollTop:0)}else{e=d.scrollLeft;d=d.scrollTop}return{left:e,top:d}},scrollBy:function(d,
e,b){var f=this.tag;if(d.length){b=e;e=d[1];d=d[0]}else if(typeof d!="number"){b=e;e=d.y;d=d.x}d&&this.scrollTo("left",Math.max(Math.min(f.scrollLeft+d,f.scrollWidth-f.clientWidth),0),b);e&&this.scrollTo("top",Math.max(Math.min(f.scrollTop+e,f.scrollHeight-f.clientHeight),0),b);return this},scrollTo:function(d,e,b){d=/top/i.test(d);var f=this.tag,c={};if(!b||!this.anim)f["scroll"+(d?"Top":"Left")]=e;else{MT.isPlainObject(b)||(b={});c["scroll"+(d?"Top":"Left")]=e;this.animate(a.mixin({to:c},b))}return this},
scroll:function(d,e,b){if(!this.isScrollable())return false;var f=this.tag,c=f.scrollLeft,g=f.scrollTop,h=false;e={l:Math.min(c+e,f.scrollWidth-f.clientWidth),r:Math.max(c-e,0),t:Math.max(g-e,0),b:Math.min(g+e,f.scrollHeight-f.clientHeight)};e.d=e.b;e.u=e.t;d=d.substr(0,1);if((e=e[d])>-1){h=true;this.scrollTo(d=="l"||d=="r"?"left":"top",e,b)}return h},scrollIntoView:function(d,e,b,f){d=a.getDom(d)||a.dom.getDoc().tag;var c=this.tag,g=this.getOffsetsTo(d),h=d.clientWidth-c.offsetWidth;c=d.clientHeight-
c.offsetHeight;var i=d.scrollLeft,j=d.scrollTop,k={};if(e){if(b)i+=g[0]-h/2;j+=g[1]-c/2}else{if(b)i+=Math.min(g[0],Math.max(g[0]-h,0));j+=Math.min(g[1],Math.max(g[1]-c,0))}if(!f||!this.anim){d.scrollTop=j;if(b)d.scrollLeft=i}else{k.scrollTop=j;if(b)k.scrollLeft=i;a.isPlainObject(f)||(f={});a.get(d).animate(a.mixin({to:k},f))}return this}},true)});
MT.add("mt-dom-alignment",function(a){var d=MT.dom.getDoc().tag,e=Math.round;a.mixin(a.Element.prototype,{getAlignToXY:function(b,f,c){b=MT.get(b);c=c||[0,0];f=(!f||f=="?"?"tl-bl?":!/-/.test(f)&&f!==""?"tl-"+f:f||"tl-bl").toLowerCase();var g,h,i=false;if(f=f.match(/^([a-z]+)-([a-z]+)(\?)?$/)){var j=f[1],k=f[2];i=!!f[3];g=this.getAnchorXY(j,true);h=b.getAnchorXY(k,false);f=h[0]-g[0]+c[0];c=h[1]-g[1]+c[1];if(i){b=this.Bound(b,f,c,j,k);f=b[0];c=b[1]}return new MT.math.Coordinate(f,c)}},Bound:function(b,
f,c,g,h){var i,j,k=MT.dom.getViewportWidth()-10,l=MT.dom.getViewportHeight()-10,n,m;m=n=false;i=d.documentElement;j=d.body;var o=i.scrollLeft||j.scrollLeft||0,p=i.scrollTop||j.scrollTop||0;i=this.outerWidth();j=this.outerHeight();b=b.getBox();if(g||h){n=g.charAt(0);g=g.charAt(g.length-1);m=h.charAt(0);h=h.charAt(h.length-1);n=n=="t"&&m=="b"||n=="b"&&m=="t";m=g=="r"&&h=="l"||g=="l"&&h=="r"}if(f+i>k+o)f=m?b.left-i:k+o-i;if(f<o)f=m?b.right:o;if(c+j>l+p)c=n?b.top-j:l+p-j;if(c<p)c=n?b.bottom:p;return[f,
c]},getAnchorXY:function(b,f,c){b=(b||"tl").toLowerCase();c=c||{};var g=this.tag,h=g==d.body||g==d;g=c.width||h?MT.dom.getViewportWidth():this.outerWidth();var i=c.height||h?MT.dom.getViewportHeight():this.outerHeight(),j=this.getXY(),k=this.getScroll();c=h?k.left:!f?j.x:0;f=h?k.top:!f?j.y:0;b={c:[e(g*0.5),e(i*0.5)],t:[e(g*0.5),0],l:[0,e(i*0.5)],r:[g,e(i*0.5)],b:[e(g*0.5),i],tl:[0,0],bl:[0,i],br:[g,i],tr:[g,0]}[b];return[b[0]+c,b[1]+f]},alignTo:function(b,f,c,g){this.setXY(this.getAlignToXY(b,f,c),
g);return this},center:function(b){return this.alignTo(b||d,"c-c")},getConstrainVector:function(b){var f=false,c=[0,0],g;if(b.tagName||MT.isString(b)||b instanceof MT.Element)g=MT.get(b).getBox();else if(a.isObject(b))g=b;else return false;b=this.getRegion();if(b.right>g.right){f=true;c[0]=g.right-b.right}if(b.left+c[0]<g.left){f=true;c[0]=g.left-b.left}if(b.bottom>g.bottom){f=true;c[1]=g.bottom-b.bottom}if(b.top+c[1]<g.top){f=true;c[1]=g.top-b.top}return f?c:false}},true)});
MT.add("mt-dom-mask",function(a){var d=a.Element,e=d.prototype,b=a.Config.win,f=a.Config.doc;e.createShim=function(){var c=f.createElement("iframe"),g=this.tag;c.frameBorder="0";c.className=MT.cssPrefix+"shim";c.target=MT.ifrmSrc;return MT.get(g.parentNode.insertBefore(c,g))};e.createProxy=function(c,g,h){c=MT.isString(c)?{"class":c}:c;var i=c.tag||"<div>";proxy=g?MT.q(i,c).appendTo(MT.getDom(g)):MT.q(i,c).insertBefore(this.tag);proxy=MT.get(proxy[0]);proxy.setDisplayMode(d.DISPLAY);proxy.hide();
h&&this.setBox&&this.getBox&&proxy.setBox(this.getBox());return proxy};e.mask=function(c,g,h){var i=this.tag,j=this.getCache().data,k=j.mask,l=j.maskMsg,n,m,o=MT.cssPrefix;this.addClass(o+"masked");this.isStyle("position","static")&&this.addClass(o+"masked-relative");k&&k.remove();l&&l.remove();n=this.createChild({"class":o+"mask"+(h!==false?"":" "+o+"mask-gray"),html:c?'<div class="'+(g||o+"mask-message")+'">'+c+"</div>":""});c=c?MT.get(n.tag.firstChild):null;m=this.getSize();j.mask=n;j.maskMsg=
c;if(i===f.body){m.width=b.innerWidth;m.height=b.innerHeight;this.maskDocResize&&a.off(b,"resize",SLOT(this.maskDocResize,this));this.maskDocResize=function(){m={};m.width=b.innerWidth;m.height=b.innerHeight;n.setSize(m)};a.on(b,"resize",SLOT(this.maskDocResize,this))}n.setSize(m);c&&c.center(n);return this};e.isMasked=function(){var c=false;if(this.getCache().data.mask)c=true;return c};e.unmask=function(){var c=this.getCache().data,g=c.mask,h=c.maskMsg,i=MT.cssPrefix;if(g){g.remove();delete c.mask}if(h){h.remove();
delete c.maskMsg}this.removeClass(i+"masked",i+"masked-relative");if(this.tag===f.body){a.off(b,"resize",SLOT(this.maskDocResize,this));delete this.maskDocResize}return this}});
MT.add("mt-dom-insertion",function(a){var d=a.Element.prototype,e=/^body/i,b=/a|button|embed|iframe|img|input|object|select|textarea/i;d.createChild=function(f,c,g){f=MT.isString(f)?{"class":f}:f;var h=f.tag||"<div>",i=this.tag;f=c?MT.q(h,f).insertBefore(i):i.firstChild&&g?MT.q(h,f).insertBefore(i.firstChild):MT.q(h,f).appendTo(i);return MT.get(f[0])};d.needsTabIndex=function(){var f=this.tag;if(f){if(f.nodeName==="a"&&!f.href)return true;return!b.test(f.nodeName)}};d.focusable=function(){var f=this.tag,
c=f.nodeName,g=false;if(!f.disabled)if(b.test(c)){if(c!=="a"||f.href)g=true}else g=!isNaN(f.tabIndex);return g&&this.isVisible(true)};d.wrap=function(f){return MT.q(this.tag).wrap(f)[0].parentNode};d.unwrap=function(){MT.q(this.tag).unwrap();return this};d.html=function(f){var c=this.tag;if(arguments.length>0)MT.q(c).html(f);else return MT.q(c).html()};d.text=function(f){var c=this.tag;if(arguments.length>0)MT.q(c).text(f);else return MT.q(c).text()};d.append=function(f){a.q(this.tag).append(f);return this};
d.prepend=function(f){a.q(this.tag).prepend(f);return this};d.insertBefore=function(f){a.q(this.tag).insertBefore(f);return this};d.insertAfter=function(f){a.q(this.tag).insertAfter(f);return this};d.empty=function(){a.q(this.tag).empty();return this};d.inDoc=function(f){var c=this.tag;f=f?f.tag||f:c.ownerDocument;if(f.documentElement)return a.dom.contains(f.documentElement,c)};d.isVisible=function(f){var c=!this.isStyle("visibility","hidden")&&!this.isStyle("display","none"),g=this.tag.parentNode;
if(f!==true||!c)return c;for(;g&&!e.test(g.tagName);){c=g.style;f=c.visibility;c=c.display;f=f?f=="hidden":false;c=c?c=="none":false;if(f&&c)return false;g=g.parentNode}return true};d.replace=function(f){var c=this.tag;if(typeof f=="string")f=a.dom.create(f);c.parentNode.replaceChild(a.getDom(f),c);return this}});
(function(a){var d=parseInt,e=RegExp;a.Color={KEYWORDS:{black:"000",silver:"c0c0c0",gray:"808080",white:"fff",maroon:"800000",red:"f00",purple:"800080",fuchsia:"f0f",green:"008000",lime:"0f0",olive:"808000",yellow:"ff0",navy:"000080",blue:"00f",teal:"008080",aqua:"0ff"},re_RGB:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,re_hex:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,re_hex3:/([0-9A-F])/gi,toRGB:function(b){a.Color.re_RGB.test(b)||(b=a.Color.toHex(b));if(a.Color.re_hex.exec(b))b="rgb("+
[d(e.$1,16),d(e.$2,16),d(e.$3,16)].join(", ")+")";return b},toHex:function(b){b=a.Color.KEYWORDS[b]||b;if(a.Color.re_RGB.exec(b)){b=[Number(e.$1).toString(16),Number(e.$2).toString(16),Number(e.$3).toString(16)];for(var f=0;f<b.length;f++)if(b[f].length<2)b[f]="0"+b[f];b=b.join("")}if(b.length<6)b=b.replace(a.Color.re_hex3,"$1$1");if(b!=="transparent"&&b.indexOf("#")<0)b="#"+b;return b.toUpperCase()}}})(MT);
MT.mtClass("MT.ElemLoader",{$extend:MT.events.EventTarget,baseParams:null,isLoader:true,autoLoad:false,statics:{autoId:100},target:null,url:null,ajaxOptions:null,loadMask:false,constructor:function(a,d){var e=MT;d=d||{};if(e.isString(a))this.qName=a;else if(e.isObject(a))d=a;e.mixin(this,d,true);this.pkg={};this.optCache={};this.setTarget(this.target);if(this.autoLoad)this.load(this.ajaxOptions||{})},isQue:function(){return this.qName?true:false},getQue:function(){if(this.isQue())return this.pkg.ajaxQ;
return null},checkQue:function(){var a;a=this.getQue();if(!a){a=MT.ajaxQ.create(this.qName,this.queueOptions||{});this.pkg.ajaxQ=a}return a},resetQue:function(a,d){if(MT.isObject(a))d=a;d=d||{};this.getQue()&&MT.ajaxQ.destroy(this.qName);if(MT.isString(a))this.qName=a;this.queueOptions=d;this.pkg.ajaxQ=MT.ajaxQ.create(this.qName,d)},load:function(a){a=MT.object.clone(a);var d=MT,e=this.pkg,b="optCache"+MT.ElemLoader.autoId++,f=this.isQue(),c=d.func,g=a.loadMask||this.loadMask,h=a.params||{},i=a.ajaxOptions||
{};d.mixin(i,this.ajaxOptions);d.mixin(a,i);d.mixin(h,this.baseParams||{},true);d.mixin(a,{url:this.url});if(!a.url)throw Error("ajax without url @dom.loader.js, attention please!");a.data=h;if(this.fire("beforeload",[this,a])!==false){if(g){this.addMask(g);e.mask=g}this.optCache[b]={mask:g,renderer:a.renderer||this.renderer,success:a.success||this.success,complete:a.complete||this.complete,error:a.error||this.error};d.mixin(a,{success:c.bind(this.onSucc,this,b),complete:c.bind(this.onComplete,this,
b),error:c.bind(this.onErr,this,b)},true);f?this.checkQue().add(a):d.ajax(a)}},onSucc:function(a,d,e,b){a=this.optCache[a]||{};this.getRenderer(a.renderer).call(this,this,d);delete a.renderer;if(a.success){a.success.call(this,d,e,b);delete a.success}},onComplete:function(a,d,e){var b=this.pkg;a=this.optCache[a]||{};this.fire("onload",[this,e]);if(a.complete){a.complete.call(this,d,e);delete a.complete}b.mask&&this.removeMask()},onErr:function(a,d,e,b){a=this.optCache[a]||{};if(a.error){a.error.call(this,
d,e,b);delete a.error}},getRenderer:function(a){if(MT.isFunction(a))return a;return this.Renderers.Html},Renderers:{Html:function(a,d){a.getTarget().html(d);return true}},addMask:function(a){this.target.mask(a===true?null:a)},setTarget:function(a){a=MT.get(a);this.getQue()&&this.target&&this.target.key!=a.key&&this.abort();this.target=a},getTarget:function(){return this.target||null},removeMask:function(){this.target.unmask()},startRefresh:function(a,d){var e=this;e.stopRefresh();e.autoRefresh=setInterval(function(){e.load(d)},
a)},stopRefresh:function(){if(this.autoRefresh){clearInterval(this.autoRefresh);delete this.autoRefresh}},clear:function(a){if(this.isQue()){this.getQue().clear(a);a&&this.pkg.mask&&this.removeMask()}},abort:function(a){this.isQue()&&this.getQue().abort(a);this.pkg.mask&&this.removeMask()},destroy:function(){this.stopRefresh();delete this.target;this.clear(true);MT.off(this);delete this.pkg;delete this.optCache}});
MT.add("dd-ddmbase",function(a){var d=function(){a.events.EventTarget.call(this)},e=a.func;a.inherits(d,a.events.EventTarget);d.prototype.get=function(b){var f=this.constructor;return f.ATTRS?f.ATTRS[b]:f[b]};d.ATTRS={dragCursor:"move",clickPixelThresh:3,clickTimeThresh:1E3,throttleTime:-1,dragMode:"point"};a.mixin(d.prototype,{_createPG:function(){},_setDragMode:function(b){if(b===null)b=a.dd.DDM.get("dragMode");switch(b){case 1:case "intersect":return 1;case 2:case "strict":return 2}return 0},CSS_PREFIX:"mt-dd",
_active:false,_activateTargets:function(){},_drags:[],activeDrag:false,getDrag:function(b){var f=false,c=MT.get(b);c instanceof a.Element&&MT.each(this._drags,function(g){if(g.node.tag===c.tag){f=g;return false}});return f},_regDrag:function(b){if(this.getDrag(b.node))return false;this._active||this._setupListeners();this._drags.push(b);return true},_unregDrag:function(b){var f;f=MT.array.findIndex(this._drags,function(c){if(c.node.key===b.node.key)return true});f!=-1&&MT.array.removeAt(this._drags,
f)},_setupListeners:function(){this._createPG();this._active=true;var b=MT.get(a.Config.doc);b.on("mousemove",e.throttle(e.bind(this._move,this),this.get("throttleTime")));b.on("mouseup",e.bind(this._end,this))},_start:function(){this.fire("ddm:start");this._startDrag()},_startDrag:function(){},_endDrag:function(){},_dropMove:function(){},_end:function(){if(this.activeDrag){this._endDrag();this.fire("ddm:end");this.activeDrag.end.call(this.activeDrag);this.activeDrag=null}},stopDrag:function(){this.activeDrag&&
this._end();return this},_move:function(b){if(this.activeDrag){this.activeDrag._move.call(this.activeDrag,b);this._dropMove()}}});a.namespace("dd");a.dd.DDM=new d;a.mixin(a.dd.DDM,{_pg:null,_debugShim:false,_activateTargets:function(){},_deactivateTargets:function(){},_startDrag:function(){if(this.activeDrag&&this.activeDrag.useShim){this._pg_activate();this._activateTargets()}},_endDrag:function(){this._pg_deactivate();this._deactivateTargets()},_pg_deactivate:function(){this._pg.setStyle("display:none")},
_pg_activate:function(){this._pg||this._createPG();var b=this.activeDrag.activeHandle,f="auto";if(b)f=b.getStyle("cursor");if(f=="auto")f=this.get("dragCursor");this._pg_size();this._pg.setStyle({top:0,left:0,display:"block",opacity:this._debugShim?".5":"0",cursor:f})},_pg_size:function(){if(this.activeDrag){var b=a.dom.getDocumentHeight(),f=a.dom.getDocumentWidth();this._pg.setStyle({height:b+"px",width:f+"px"})}},_createPG:function(){var b=a.q("<div></div>"),f=a.q("body");b=a.get(b[0]);b.setStyle({top:"0",
left:"0",position:"absolute",zIndex:"9999",overflow:"hidden",backgroundColor:"red",display:"none",height:"5px",width:"5px"});b.set({id:"pg_"+b.key},false);b.addClass(this.CSS_PREFIX+"-shim");f.prepend(b.tag);this._pg=b;this._pg.on("mousemove",e.throttle(e.bind(this._move,this),this.get("throttleTime")));this._pg.on("mouseup",e.bind(this._end,this));b=a.get(a.Config.win);b.on("resize",e.bind(this._pg_size,this));b.on("scroll",e.bind(this._pg_size,this))}},true);a.mixin(a.dd.DDM,{_noShim:false,_activeShims:[],
_hasActiveShim:function(){if(this._noShim)return true;return this._activeShims.length},_addActiveShim:function(b){this._activeShims[this._activeShims.length]=b},_removeActiveShim:function(b){var f=[];a.each(this._activeShims,function(c){if(c.key!==b.key)f[f.length]=c});this._activeShims=f},syncActiveShims:function(b){e.delay(function(f){f=f?this.targets:this._lookup();a.each(f,function(c){c.sizeShim.call(c)},this)},0,this,b)},mode:0,POINT:0,INTERSECT:1,STRICT:2,useHash:true,activeDrop:null,validDrops:[],
otherDrops:{},targets:[],_addValid:function(b){this.validDrops[this.validDrops.length]=b;return this},_removeValid:function(b){var f=[];a.each(this.validDrops,function(c){if(c!==b)f[f.length]=c});this.validDrops=f;return this},isOverTarget:function(b){if(this.activeDrag&&b){var f=this.activeDrag.mouseXY,c=this.activeDrag.dragMode,g,h=b.shim;if(f&&this.activeDrag){g=this.activeDrag.region;if(c==this.STRICT)return this.activeDrag.dragNode.inRegion(b.region,true,g);else if(b&&b.shim)if(c==this.INTERSECT&&
this._noShim){f=g?g:this.activeDrag.node;return b.node.inRegion(f,false,b.region)}else{if(this._noShim)h=b.node;return h.inRegion({top:f[1],bottom:f[1],left:f[0],right:f[0]},false,b.region)}else return false}else return false}else return false},clearCache:function(){this.validDrops=[];this.otherDrops={};this._activeShims=[]},_activateTargets:function(){this._noShim=true;this.clearCache();a.each(this.targets,function(b){b._activateShim([]);if(b.noShim==true)this._noShim=false},this);this._handleTargetOver()},
getBestMatch:function(b,f){var c=null,g=0,h;a.each(b,function(i){var j=this.activeDrag.dragNode.intersect(i.node);i.region.area=j.area;if(j.inRegion)if(j.area>g){g=j.area;c=i}},this);if(f){h=[];a.each(b,function(i){if(i!==c)h[h.length]=i},this);return[c,h]}else return c},_deactivateTargets:function(){var b=[],f=this.activeDrag,c=this.activeDrop;if(f&&c&&this.otherDrops[c]){if(f.dragMode){b=this.getBestMatch(this.otherDrops,true);c=b[0];b=b[1]}else{b=this.otherDrops;delete b[c]}f.node.removeClass(this.CSS_PREFIX+
"-drag-over");if(c){c.fire("drop:hit",{drag:f,drop:c,others:b});f.fire("drag:drophit",{drag:f,drop:c,others:b})}}else if(f&&f.dragging){f.node.removeClass(this.CSS_PREFIX+"-drag-over");f.fire("drag:dropmiss",{pageX:f.lastXY[0],pageY:f.lastXY[1]})}this.activeDrop=null;a.each(this.targets,function(g){g._deactivateShim([])},this)},_dropMove:function(){this._hasActiveShim()?this._handleTargetOver():a.each(this.otherDrops,function(b){b._handleOut.apply(b,[])})},_lookup:function(){if(!this.useHash||this._noShim)return this.validDrops;
var b=[];a.each(this.validDrops,function(f){if(f.shim&&f.shim.inViewportRegion(false,f.region))b[b.length]=f});return b},_handleTargetOver:function(){var b=this._lookup();a.each(b,function(f){f._handleTargetOver.call(f)},this)},_regTarget:function(b){this.targets[this.targets.length]=b},_unregTarget:function(b){var f=[],c;a.each(this.targets,function(g){if(g!=b)f[f.length]=g},this);this.targets=f;c=[];a.each(this.validDrops,function(g){if(g!==b)c[c.length]=g});this.validDrops=c},getDrop:function(b){var f=
false,c=a.get(b);c instanceof Y.Node&&a.each(this.targets,function(g){if(c.key===g.node.key)f=g});return f}},true)});
MT.add("dd-drag",function(a){function d(c){a.events.EventTarget.call(this);c=c||{};if(!f._regDrag(this))throw Error("Failed to register node, already in use: "+c.node);this.initializer(c)}a.inherits(d,a.events.EventTarget);var e=d.prototype,b=a.func,f=a.dd.DDM;e.offsetNode=true;e.startCentered=false;e.clickPixelThresh=f.get("clickPixelThresh");e.clickTimeThresh=f.get("clickTimeThresh");e.lock=false;e.setLock=function(c){this.node[c?"addClass":"removeClass"](f.CSS_PREFIX+"-locked");this.lock=c||false;
return this};e.data=false;e.move=true;e.useShim=true;e.activeHandle=false;e.primaryButtonOnly=true;e.dragging=false;e.parent=false;e.target=false;e.setTarget=function(c){this._handleTarget(c);return this};e.dragMode=null;e.setMode=function(c){this.dragMode=c;f._setDragMode(c);return this};e.groups=["default"];e.getGroups=function(){if(!this._groups)this._groups={};var c=[];a.each(this._groups,function(g,h){c[c.length]=h});return c};e.setGroups=function(c){this._groups={};a.each(c,function(g){this._groups[g]=
true},this);return this};e.handles=null;e.setHandles=function(c){if(c){this._handles={};a.each(c,function(g){var h=g;if(g instanceof a.Element)h=g.key;this._handles[h]=g},this)}else this._handles=null;return this};e.haltDown=true;e._bubbleTargets=a.dd.DDM;e.addToGroup=function(c){this._groups[c]=true;f._activateTargets();return this};e.removeFromGroup=function(c){delete this._groups[c];f._activateTargets();return this};e.target=null;e._handleTarget=function(c){if(a.dd.Drop)if(c===false){if(this.target){f._unregTarget(this.target);
this.target=null}return false}else{a.isObject(c)||(c={});c.node=this.node;c.groups=c.groups||this.groups;this.target=new a.dd.Drop(c)}else return false};e._groups=null;e._createEvents=function(){this.on("drag:mouseDown",this._defMouseDownFn,this);this.on("drag:align",this._defAlignFn,this);this.on("drag:drag",this._defDragFn,this);this.on("drag:end",this._defEndFn,this)};e._ev_md=null;e._startTime=null;e._endTime=null;e._handles=null;e._invalids=null;e._invalidsDefault={textarea:true,input:true,a:true,
button:true,select:true};e._dragThreshMet=null;e.deltaXY=null;e.startXY=null;e.nodeXY=null;e.lastXY=null;e.actXY=null;e.realXY=null;e.mouseXY=null;e.region=null;e._handleMouseUp=function(){this.fire("drag:mouseup");this._fixIEMouseUp();f.activeDrag&&f._end()};e._fixDragStart=function(c){c.preventDefault()};e._ieSelectFix=function(){return false};e._ieSelectBack=null;e._fixIEMouseDown=function(){if(a.ua.ie){this._ieSelectBack=a.Config.doc.body.onselectstart;a.Config.doc.body.onselectstart=this._ieSelectFix}};
e._fixIEMouseUp=function(){if(a.ua.ie)a.Config.doc.body.onselectstart=this._ieSelectBack};e._handleMouseDownEvent=function(c){this.fire("drag:mouseDown",c)};e.validClick=function(c){var g=false,h=false,i=c.target,j=null,k=null,l=/^\./;set=false;if(this._handles)a.each(this._handles,function(n,m){if(n instanceof a.Element){if(!g)if(n.contains(i)){g=true;return false}}else if(a.isString(m)){m=m.replace(/^#/,"");j=a.q((l.test(m)?"":"#")+m);j=j[0];if(!k&&(j===i||a.dom.contains(j,i))){g=true;k=j;return false}}});
else{h=this.node;if(h.contains(i))g=true}g&&this._invalids&&a.each(this._invalids,function(n,m){if(a.isString(m))if(i.tagName.toLowerCase()===m)return g=false});if(g)this.activeHandle=k?a.get(k):this.node;return g};e._setStartPosition=function(c){this.startXY=c;c=this.node.getXY();this.nodeXY=this.lastXY=this.realXY=[c.x,c.y];this.deltaXY=this.offsetNode?[this.startXY[0]-this.nodeXY[0],this.startXY[1]-this.nodeXY[1]]:[0,0]};e._defMouseDownFn=function(c){this._dragThreshMet=false;this._ev_md=c;if(this.primaryButtonOnly&&
c.which>1)return false;if(this.validClick(c)){this._fixIEMouseDown(c);this.haltDown?c.halt():c.preventDefault();this._setStartPosition([c.pageX,c.pageY]);f.activeDrag=this}this.fire("drag:afterMouseDown",c)};e.removeHandle=function(c){var g=c;if(c instanceof a.Element)g=c.key;if(this._handles[g]){delete this._handles[g];this.fire("drag:removeHandle",{handle:c})}return this};e.addHandle=function(c){if(!this._handles)this._handles={};var g=c;if(c instanceof a.Element)g=c.key;this._handles[g]=c;this.fire("drag:addHandle",
{handle:c});return this};e.removeInvalid=function(c){if(this._invalids[c]){this._invalids[c]=null;delete this._invalids[c];this.fire("drag:removeInvalid",{handle:c})}return this};e.addInvalid=function(c){if(a.isString(c)){this._invalids[c]=true;this.fire("drag:addInvalid",{handle:c})}return this};e.setValue_=b.setter(function(c,g){if(a.isFunction(this[c]))this[c](g);else if(a.isFunction(this["set"+a.string.capitalFirst(c)]))this["set"+a.string.capitalFirst(c)](g);else this[c]=g});e.initializer=function(c){this.setValue_(c);
this.node=a.get(c.node);this.dragNode=c.handle?a.get(c.handle):this.node;this.node.dd=this;this.actXY=[];this._invalids=a.mixin({},this._invalidsDefault,true);this._createEvents();this._prep();this.setGroups(this.groups);this.constrainCfg&&this.constrain(this.constrainCfg);this.proxyCfg&&this.proxy(this.proxyCfg)};e._prep=function(){this._dragThreshMet=false;var c=this.node;c.addClass(f.CSS_PREFIX+"-draggable");c.on("mousedown",b.bind(this._handleMouseDownEvent,this));c.on("mouseup",b.bind(this._handleMouseUp,
this));c.on("dragstart",b.bind(this._fixDragStart,this))};e._unprep=function(){var c=this.node;c.removeClass(f.CSS_PREFIX+"-draggable");c.off("mouseup");c.off("dragstart");c.off("mousedown");this.mouseXY=[];this.deltaXY=[0,0];this.startXY=[];this.nodeXY=[];this.lastXY=[];this.actXY=[];this.realXY=[]};e.start=function(){if(!this.lock&&!this.dragging){var c=this.node,g,h;this._startTime=(new Date).getTime();f._start();c.addClass(f.CSS_PREFIX+"-dragging");this.fire("drag:start",{pageX:this.nodeXY[0],
pageY:this.nodeXY[1],startTime:this._startTime});c=this.dragNode;h=this.nodeXY;g=c.tag.offsetWidth;c=c.tag.offsetHeight;this.startCentered&&this._setStartPosition([h[0]+g/2,h[1]+c/2]);this.region={"0":h[0],"1":h[1],area:0,top:h[1],right:h[0]+g,bottom:h[1]+c,left:h[0]};this.dragging=true}return this};e.end=function(){this._endTime=(new Date).getTime();this._dragThreshMet=false;!this.lock&&this.dragging&&this.fire("drag:end",{pageX:this.lastXY[0],pageY:this.lastXY[1],startTime:this._startTime,endTime:this._endTime});
this.node.removeClass(f.CSS_PREFIX+"-dragging");this.dragging=false;this.deltaXY=[0,0];return this};e._defEndFn=function(){this._fixIEMouseUp();this._ev_md=null};e.prevEnd=function(){this._fixIEMouseUp();this.dragNode.setXY({x:this.nodeXY[0],y:this.nodeXY[1]});this.region=this._ev_md=null};e._align=function(c){this.fire("drag:align",{pageX:c[0],pageY:c[1]})};e._defAlignFn=function(c){this.actXY=[c.pageX-this.deltaXY[0],c.pageY-this.deltaXY[1]]};e._alignNode=function(c,g){this._align(c);g||this._moveNode()};
e._moveNode=function(c){var g=[],h=[],i=this.nodeXY,j=this.actXY;g[0]=j[0]-this.lastXY[0];g[1]=j[1]-this.lastXY[1];h[0]=j[0]-this.nodeXY[0];h[1]=j[1]-this.nodeXY[1];this.region={"0":j[0],"1":j[1],area:0,top:j[1],right:j[0]+this.dragNode.tag.offsetWidth,bottom:j[1]+this.dragNode.tag.offsetHeight,left:j[0]};this.fire("drag:drag",{pageX:j[0],pageY:j[1],scroll:c,info:{start:i,xy:j,delta:g,offset:h}});this.lastXY=j};e._defDragFn=function(c){if(this.move){if(c.scroll&&c.scroll.node){c.scroll.node.scrollTo("left",
c.scroll.top);c.scroll.node.scrollTo("top",c.scroll.left)}this.dragNode.setXY({x:c.pageX,y:c.pageY});this.realXY=[c.pageX,c.pageY]}};e._move=function(c){if(this.lock)return false;else{this.mouseXY=[c.pageX,c.pageY];if(this._dragThreshMet)this._alignNode([c.pageX,c.pageY]);else{var g=Math.abs(this.startXY[1]-c.pageY);if(Math.abs(this.startXY[0]-c.pageX)>this.clickPixelThresh||g>this.clickPixelThresh){this._dragThreshMet=true;this.start();this._alignNode([c.pageX,c.pageY])}}}};e.stopDrag=function(){this.dragging&&
f._end();return this};e.constrain=function(c){if(a.Plugin&&a.Plugin.DDConstrained&&!this._constrain)this._constrain=new a.Plugin.DDConstrained(this,c);return this};e.proxy=function(c){if(a.Plugin&&a.Plugin.DDProxy&&!this._proxy)this._proxy=new a.Plugin.DDProxy(this,c);return this};e.dispose=function(){this._unprep();if(this._constrain){this._constrain.dispose();delete this._constrain}if(this._proxy){this._proxy.dispose();delete this._proxy}this.dragTarget&&delete this.dragTarget;f._unregDrag(this)};
a.namespace("dd");a.dd.Drag=d});
MT.add("dd-constrain",function(a){function d(c,g){a.events.EventTarget.call(this);g=g||{};this.host=c;this.initializer(g)}var e=a.dd.DDM,b,f=a.func;a.inherits(d,a.events.EventTarget);b=d.prototype;b.stickX=false;b.stickY=false;b.tickX=false;b.tickY=false;b.tickXArray=false;b.tickYArray=false;b.gutter=0;b.setGutter=function(c){this.gutter=a.style.cssSizestoObject(c);return this};b.constrain="view";b.setConstrain=function(c){a.get(c);return this};b.constrain2region=function(c){this.constrain=c;return this};
b.constrain2node=function(c){this.constrain=a.get(c);return this};b.constrain2view=function(){this.constrain="view"};b.cacheRegion=true;b._lastTickXFired=null;b._lastTickYFired=null;b.setValue_=f.setter(function(c,g){if(a.isFunction(this[c]))this[c](g);else if(a.isFunction(this["set"+a.string.capitalFirst(c)]))this["set"+a.string.capitalFirst(c)](g);else this[c]=g});b.initializer=function(c){this._createEvents();this.setValue_(c);this._eventHandles={"drag:end":this.host.on("drag:end",f.bind(this._handleEnd,
this)),"drag:start":this.host.on("drag:start",f.bind(this._handleStart,this)),"drag:align":this.host.on("drag:align",f.bind(this.align,this)),"drag:drag":this.host.on("drag:drag",f.bind(this.drag,this))}};b.dispose=function(){a.each(this._eventHandles,function(c,g){c.off(g)});this._eventHandles={}};b._createEvents=function(){};b._handleEnd=function(){this._lastTickXFired=this._lastTickYFired=null};b._handleStart=function(){this.resetCache()};b._regionCache=null;b._cacheRegion=function(){this._regionCache=
this.constrain.getBox()};b.resetCache=function(){this._regionCache=null};b._getConstraint=function(){var c=this.constrain,g=this.gutter,h;if(c)if(c instanceof a.Element){if(!this._regionCache){this._eventHandles.resize=a.on(a.Config.win,"resize",f.bind(this._cacheRegion,this));this._cacheRegion()}h=a.object.clone(this._regionCache);this.cacheRegion||this.resetCache()}else if(a.isObject(c))h=a.object.clone(c);if(!c||!h)c="view";if(c==="view")h=this.host.dragNode.getViewPortRegion();a.each(g,function(i,
j){if(j=="right"||j=="bottom")h[j]-=i;else h[j]+=i});return h};b.getRegion=function(c){var g={},h=null,i=null;i=this.host.dragNode;g=this._getConstraint();if(c){h=i.tag.offsetHeight;i=i.tag.offsetWidth;g.right-=i;g.bottom-=h}return g};b._checkRegion=function(c){var g=this.getRegion(),h=this.host.dragNode,i=h.tag.offsetHeight;h=h.tag.offsetWidth;if(c[1]>g.bottom-i)c[1]=g.bottom-i;if(g.top>c[1])c[1]=g.top;if(c[0]>g.right-h)c[0]=g.right-h;if(g.left>c[0])c[0]=g.left;return c};b.inRegion=function(c){c=
c||this.host.dragNode.getXY();var g=this._checkRegion([c[0],c[1]]),h=false;if(c[0]===g[0]&&c[1]===g[1])h=true;return h};b.align=function(){var c=this.host,g=[c.actXY[0],c.actXY[1]],h=this.getRegion(true);if(this.stickX)g[1]=c.startXY[1]-c.deltaXY[1];if(this.stickY)g[0]=c.startXY[0]-c.deltaXY[0];if(h)g=this._checkRegion(g);g=this._checkTicks(g,h);c.actXY=g};b.drag=function(){var c=this.host,g=this.tickY;c=[c.actXY[0],c.actXY[1]];if((a.isNumber(this.tickX)||this.tickXArray)&&this._lastTickXFired!==
c[0]){this._tickAlignX();this._lastTickXFired=c[0]}if((a.isNumber(g)||this.tickYArray)&&this._lastTickYFired!==c[1]){this._tickAlignY();this._lastTickYFired=c[1]}};b._checkTicks=function(c,g){var h=this.host,i=h.startXY[0]-h.deltaXY[0];h=h.startXY[1]-h.deltaXY[1];var j=this.tickX,k=this.tickY;if(j&&!this.tickXArray)c[0]=e._calcTicks(c[0],i,j,g.left,g.right);if(k&&!this.tickYArray)c[1]=e._calcTicks(c[1],h,k,g.top,g.botom);if(this.tickXArray)c[0]=e._calcTickArray(c[0],this.tickXArray,g.left,g.right);
if(this.tickYArray)c[1]=e._calcTickArray(c[1],this.tickYArray,g.top,g.botom);return c};b._tickAlignX=function(){this.fire("drag:tickAlignX")};b._tickAlignY=function(){this.fire("drag:tickAlignY")};a.namespace("Plugin");a.Plugin.DDConstrained=d;a.mixin(e,{_calcTicks:function(c,g,h,i,j){var k=(c-g)/h,l=Math.floor(k),n=Math.ceil(k);if(l!==0||n!==0)if(k>=l&&k<=n){c=g+h*l;if(i&&j){if(c<i)c=g+h*(l+1);if(c>j)c=g+h*(l-1)}}return c},_calcTickArray:function(c,g,h,i){var j=0,k=g.length,l=0,n;if(!g||g.length===
0)return c;else if(g[0]>=c)return g[0];else{for(j=0;j<k;j++){l=j+1;if(g[l]&&g[l]>=c){n=c-g[j];c=g[l]-c;l=c>n?g[j]:g[l];if(h&&i)if(l>i)l=g[j]?g[j]:g[k-1];return l}}return g[g.length-1]}}})});
MT.add("dd-proxy",function(a){function d(c,g){this.host=c;this.initializer(g)}var e=a.dd.DDM,b,f=a.func;b=d.prototype;b.moveOnEnd=true;b.hideOnEnd=true;b.resizeFrame=true;b.positionProxy=true;b.borderStyle="1px solid #808080";b.cloneNode=false;b._hands=null;b._init=function(){if(e._proxy){if(!this._hands)this._hands={};var c,g,h=this.host;if(h.dragNode.key===h.node.key)if(e._proxy)h.dragNode=e._proxy;a.each(this._hands,function(i,j){i.off(j)});c=e.on("ddm:start",f.bind(function(){e.activeDrag===h&&
e._setFrame(h)},this));g=e.on("ddm:end",f.bind(function(){if(h.dragging){if(this.moveOnEnd){var i=h.lastXY;h.node.setXY({x:i[0],y:i[1]})}this.hideOnEnd&&h.dragNode.setStyle("display:none");if(this.cloneNode){h.dragNode.remove();h.dragNode=e._proxy}}},this));this._hands={"ddm:start":c,"ddm:end":g}}else{e._createFrame();a.ready(f.bind(this._init,this))}};b.setValue_=f.setter(function(c,g){if(a.isFunction(this[c]))this[c](g);else if(a.isFunction(this["set"+a.string.capitalFirst(c)]))this["set"+a.string.capitalFirst(c)](g);
else this[c]=g});b.initializer=function(c){this.setValue_(c);this._init()};b.dispose=function(){var c=this.host;a.each(this._hands,function(g,h){g.off(h)});c.dragNode=c.node};b.clone=function(){var c=this.host,g=c.node,h=g.tag.cloneNode(true);h.setAttribute("id",a.guid());h.style.position="absolute";g.tag.parentNode.appendChild(h);h=a.get(h);return c.dragNode=h};a.namespace("Plugin");a.Plugin.DDProxy=d;a.mixin(e,{_createFrame:function(){if(!e._proxy){e._proxy=true;var c,g=a.q("body");c=a.q("<div></div>").css({position:"absolute",
display:"none",zIndex:"999",top:"-999px",left:"-999px"});g.prepend(c);c=c[0];c.id=a.guid();c=a.get(c);c.addClass(e.CSS_PREFIX+"-proxy");e._proxy=c}},_setFrame:function(c){var g=c.node,h=c.dragNode,i,j="auto";if(i=e.activeDrag.activeHandle)j=i.getStyle("cursor");if(j==="auto")j=e.dragCursor;h.setStyle({visibility:"hidden",display:"block",cursor:j,border:c._proxy.borderStyle});if(c._proxy.cloneNode)h=c._proxy.clone();c._proxy.resizeFrame&&h.setStyle({height:g.tag.offsetHeight+"px",width:g.tag.offsetWidth+
"px"});if(c._proxy.positionProxy){c=c.nodeXY;h.setXY({x:c[0],y:c[1]})}h.setStyle("visibility:visible")}})});
MT.add("dd-drop",function(a){function d(c){a.events.EventTarget.call(this);c=c||{};a.ready(f.bind(function(){f.delay(this._createShim,100,this)},this));e._regTarget(this);this.initializer(c)}var e=a.dd.DDM,b,f=a.func;a.inherits(d,a.events.EventTarget);b=d.prototype;b.groups=["default"];b.getGroups=function(){if(!this._groups)this._groups={};var c=[];a.each(this._groups,function(g,h){c[c.length]=h});return c};b.setGroups=function(c){this._groups={};a.each(c,function(g){this._groups[g]=true},this);
return c};b.padding="0";b.setPadding=function(c){this.padding=a.style.cssSizestoObject(c);return this};b.lock=false;b.setLock=function(c){this.node[c?"addClass":"removeClass"](e.CSS_PREFIX+"-drop-locked");this.lock=c||false;return this};b.bubbles=function(c){this.addTarget(c);return this};b.useShim=true;b.setUseShim=function(c){a.dd.DDM._noShim=!c;return this};b._bubbleTargets=a.dd.DDM;b.addToGroup=function(c){this._groups[c]=true;return this};b.removeFromGroup=function(c){delete this._groups[c];
return this};b._createEvents=function(){};b._valid=null;b._groups=null;b.shim=null;b.region=null;b.overTarget=null;b.inGroup=function(c){var g=this._valid=false;a.each(c,function(h){if(this._groups[h])this._valid=g=true},this);return g};b.setValue_=f.setter(function(c,g){if(a.isFunction(this[c]))this[c](g);else if(a.isFunction(this["set"+a.string.capitalFirst(c)]))this["set"+a.string.capitalFirst(c)](g);else this[c]=g});b.initializer=function(c){this.setValue_(c);f.delay(this._createEvents,100,this);
this.node=a.get(c.node);this.node.drop=this;c=this.node;if(!c.tag.id)c.tag.id=a.guid();c.addClass(e.CSS_PREFIX+"-drop");this.setPadding(this.padding);this.setGroups(this.groups)};b.dispose=function(){e._unregTarget(this);if(this.shim&&this.shim!==this.node){a.off(this.shim);this.shim.remove();this.shim=null}this.node.removeClass(e.CSS_PREFIX+"-drop");a.off(this)};b._deactivateShim=function(){if(!this.shim)return false;this.node.removeClass(e.CSS_PREFIX+"-drop-active-valid");this.node.removeClass(e.CSS_PREFIX+
"-drop-active-invalid");this.node.removeClass(e.CSS_PREFIX+"-drop-over");this.useShim&&this.shim.setStyle({top:"-999px",left:"-999px",zIndex:"1"});this.overTarget=false};b._activateShim=function(){if(!e.activeDrag)return false;if(this.node===e.activeDrag.node)return false;if(this.lock)return false;var c=this.node;if(this.inGroup(e.activeDrag.groups)){c.removeClass(e.CSS_PREFIX+"-drop-active-invalid");c.addClass(e.CSS_PREFIX+"-drop-active-valid");e._addValid(this);this.overTarget=false;if(!this.useShim)this.shim=
this.node;this.sizeShim()}else{e._removeValid(this);c.removeClass(e.CSS_PREFIX+"-drop-active-valid");c.addClass(e.CSS_PREFIX+"-drop-active-invalid")}};b.sizeShim=function(){if(!e.activeDrag)return false;if(this.node===e.activeDrag.node)return false;if(this.lock)return false;if(!this.shim){f.delay(this.sizeShim,100,this);return false}var c=this.node,g=c.tag.offsetHeight,h=c.tag.offsetWidth;c=c.getXY();c=[c.x,c.y];var i=this.padding,j,k;h=h+i.left+i.right;g=g+i.top+i.bottom;c[0]-=i.left;c[1]-=i.top;
if(e.activeDrag.dragMode===e.INTERSECT){i=e.activeDrag;j=i.node.tag.offsetHeight;k=i.node.tag.offsetWidth;g+=j;h+=k;c[0]-=k-i.deltaXY[0];c[1]-=j-i.deltaXY[1]}this.useShim&&this.shim.setStyle({height:g+"px",width:h+"px",top:c[1]+"px",left:c[0]+"px"});this.region={"0":c[0],"1":c[1],area:0,top:c[1],right:c[0]+h,bottom:c[1]+g,left:c[0]}};b._createShim=function(){if(e._pg){if(!this.shim){var c=this.node;if(this.useShim){c=a.q('<div id="'+this.node.tag.id+'_shim"></div>');c.css({height:this.node.tag.offsetHeight+
"px",width:this.node.tag.offsetWidth+"px",backgroundColor:"yellow",opacity:".5",zIndex:"1",overflow:"hidden",top:"-900px",left:"-900px",position:"absolute"});e._pg.tag.appendChild(c[0]);c=a.get(c[0]);c.on("mouseover",f.bind(this._handleOverEvent,this));c.on("mouseout",f.bind(this._handleOutEvent,this))}this.shim=c}}else f.delay(this._createShim,10,this)};b._handleTargetOver=function(){if(e.isOverTarget(this)){this.node.addClass(e.CSS_PREFIX+"-drop-over");e.activeDrop=this;e.otherDrops[this]=this;
if(this.overTarget){e.activeDrag.fire("drag:over",{drop:this,drag:e.activeDrag});this.fire("drop:over",{drop:this,drag:e.activeDrag})}else if(e.activeDrag.dragging){this.overTarget=true;this.fire("drop:enter",{drop:this,drag:e.activeDrag});e.activeDrag.fire("drag:enter",{drop:this,drag:e.activeDrag});e.activeDrag.node.addClass(e.CSS_PREFIX+"-drag-over")}}else this._handleOut()};b._handleOverEvent=function(){this.shim.setStyle("zIndex:999");e._addActiveShim(this)};b._handleOutEvent=function(){this.shim.setStyle("zIndex:1");
e._removeActiveShim(this)};b._handleOut=function(c){if(!e.isOverTarget(this)||c)if(this.overTarget){this.overTarget=false;c||e._removeActiveShim(this);if(e.activeDrag){this.node.removeClass(e.CSS_PREFIX+"-drop-over");e.activeDrag.node.removeClass(e.CSS_PREFIX+"-drag-over");this.fire("drop:exit",{drop:this,drag:e.activeDrag});e.activeDrag.fire("drag:exit",{drop:this,drag:e.activeDrag});delete e.otherDrops[this]}}};a.namespace("dd");a.dd.Drop=d});
MT.add("dd-delegate",function(a){var d=function(g){g=g||{};this.initializer(g)},e=a.func,b=a.get(a.q("<div>Temp Node</div>")[0]),f,c=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/;f=d.prototype;f._bubbleTargets=a.dd.DDM;f.dd=null;f._shimState=null;f._handles=null;f._onNodeChange=function(g){this.dragNode=g.newVal};f._afterDragEnd=function(){a.dd.DDM._noShim=this._shimState;this.lastNode=this.dd.node;this.lastNode.removeClass(a.dd.DDM.CSS_PREFIX+"-dragging");this.dd._unprep()};f._afterDragEnd.priority=9;
f._delMouseDown=function(g){var h=g.currentTarget,i=this.dd,j=a.get(h),k=this.dragConfig,l=c.exec(this.nodes);if(l){l[1]=(l[1]||"").toLowerCase();l[3]=l[3]&&RegExp("(?:^|\\s)"+l[3]+"(?:\\s|$)")}var n=h.tagName.toLowerCase(),m=h.attributes||{};if((!l[1]||h.nodeName.toLowerCase()===l[1])&&(!l[2]||(m.id||{}).value===l[2])&&(!l[3]||l[3].test((m["class"]||{}).value))&&this.invalid.indexOf(n+",")==-1){this._shimState=a.dd.DDM._noShim;a.dd.DDM._noShim=true;this.currentNode=j;i.node=j;if(k&&k.dragNode)j=
k.dragNode;else if(i._proxy)j=a.dd.DDM._proxy;i.dragNode=j;i._prep();i.fire("drag:mouseDown",g)}};f._onMouseEnter=function(){this._shimState=a.dd.DDM._noShim;a.dd.DDM._noShim=true};f._onMouseLeave=function(){a.dd.DDM._noShim=this._shimState};f.setValue_=e.setter(function(g,h){if(a.isFunction(this[g]))this[g](h);else if(a.isFunction(this["set"+a.string.capitalFirst(g)]))this["set"+a.string.capitalFirst(g)](h);else this[g]=h});f.initializer=function(g){this._handles={};this.setValue_(g);g=this.dragConfig||
{};var h=a.getDom(this.container);g.node=b.tag.cloneNode(true);g.bubbleTargets=this;if(this.handles)g.handles=this.handles;this.dd=new a.dd.Drag(g);this.dd.on("drag:end",this._afterDragEnd,this);this.dd.on("dragNodeChange",e.bind(this._onNodeChange,this));this.dd.on("drag:mouseup",function(){this.dd._unprep()},this);this._handles.mousedown=a.on(h,"mousedown",this.nodes,e.bind(this._delMouseDown,this));this._handles.mouseenter=a.on(h,"mouseenter",e.bind(this._onMouseEnter,this));this._handles.mouseleave=
a.on(h,"mouseleave",e.bind(this._onMouseLeave,this));e.delay(this.syncTargets,50,this);a.dd.DDM.regDelegate(this)};f.syncTargets=function(){if(!(!a.dd.Drop||this.destroyed)){var g,h,i;if(this.target){g=a.q(this.container).find(this.nodes);h=this.dd.groups;if((i=this.dragConfig)&&"groups"in i)h=i.groups;a.each(g,function(j){this.createDrop(j,h)},this)}return this}};f.createDrop=function(g,h){var i={useShim:false,bubbleTargets:this};g=a.get(g);if(!g.drop){i.node=g;g.drop=new a.dd.Drop(i)}g.drop.setValue_("groups",
h);return g};f.dispose=function(){this.dd&&this.dd.dispose();if(a.dd.Drop){var g=a.q(this.container).find(this.nodes);a.each(g,function(h){h=a.get(h);h.drop&&h.drop.dispose()})}a.each(this._handles,function(h,i){h.off(i)})};f.container="body";f.nodes=".dd-draggable";f.invalid="input, select, button, a, textarea";f.lastNode=b;f.currentNode=b;f.dragNode=b;f.over=false;f.target=false;f.dragConfig=null;f.handles=null;a.mixin(a.dd.DDM,{_delegates:[],regDelegate:function(g){this._delegates.push(g)},getDelegate:function(g){var h=
null;g=a.get(g);a.each(this._delegates,function(i){if(g.tag===a.getDom(i.container))h=i},this);return h}});a.namespace("dd");a.dd.Delegate=d});
MT.add("mt-layer",function(a){var d=1E3,e=a.Config.doc;a.mtClass("MT.Layer",{$extend:a.Element,constructor:function(b){b=b||{};var f=b.renderTo;f=f?a.getDom(f):e.body;var c,g=b.hideMode;if(b.node)this.tag=a.getDom(b.node);if(this.tag){this.addClass(a.cssPrefix+"layer");this.tag.parentNode||f.appendChild(this.tag)}else{c=b.dh?b.dh.tag:"<div>";this.tag=a.q(c,b.dh||{"class":a.cssPrefix+"layer"}).appendTo(f);this.tag=this.tag.get(0)}this.id=this.tag.id=b.id||a.cssPrefix+"layer"+ ++d;this.key=a.getUid(this.tag);
a.Element.call(this,this.key,this.tag);b.cls&&this.addClass(b.cls);this.constrain=b.constrain!==false;if(g)this.setDisplayMode(a.Element[g.toUpperCase()]);else b.useDisplay?this.setDisplayMode(a.Element.DISPLAY):this.setDisplayMode(a.Element.VISIBILITY);this.useShim=b.shim!==false&&a.ua.ie6;b.hidden===true?this.hide():this.show()},statics:{shims:[]},isLayer:true,getZIndex:function(){return parseInt((this.getShim()||this).getStyle("z-index"),10)},getShim:function(){var b,f;if(!this.useShim)return null;
if(!this.shim){b=a.Layer.shims.shift();if(!b){b=this.createShim();this.setDisplayMode(a.Element.DISPLAY);this.getCache().data.originalDisplay="block";b.hide()}f=this.tag.parentNode;b.tag.parentNode!=f&&f.insertBefore(b.tag,this.tag);this.shim=b}return this.shim},hideShim:function(){if(this.shim){this.shim.setDisplayed(false);a.Layer.shims.push(this.shim);delete this.shim}},sync:function(){var b,f,c,g,h,i;h=this.tag;if(!this.updating&&this.isVisible()&&this.useShim){b=this.getShim();f=this.getLeft();
c=this.getTop();g=h.offsetWidth;h=h.offsetHeight;if(b){i=b.getStyle("z-index");i>this.zindex&&this.shim.setStyle("z-index:"+this.zindex-2);b.show();b.setSize(g,h);b.setLeftTop(f,c)}}return this},remove:function(){this.hideUnders_();this.callParent()},hideUnders_:function(){this.hideShim()},beginUpdate_:function(){this.updating=true},endUpdate_:function(){this.updating=false;this.sync(true)},constrainXY:function(){if(this.constrain){var b=a.dom.getViewportWidth(),f=a.dom.getViewportHeight(),c=a.get(e).getScroll(),
g=this.getXY(),h=g.x;g=g.y;var i=this.tag.offsetWidth,j=this.tag.offsetHeight,k=false;if(h+i>b+c.left){h=b-i-0;k=true}if(g+j>f+c.top){g=f-j-0;k=true}if(h<c.left){h=c.left;k=true}if(g<c.top){g=c.top;k=true}if(k){a.Layer.superClass_.setXY.call(this,{x:h,y:g});this.sync()}}return this},setVisible_:function(b,f){var c=this,g,h=null;g=function(){b&&c.sync(true);if(f)h=a.isPlainObject(f)?f.onEnd:f;h&&a.isFunction(h)&&h()};if(f&&a.isPlainObject(f))f.onEnd=g;b||c.hideUnders_(true);c.callParent([b,f]);f||
g();return c},beforeAction_:function(){},setLeft:function(){this.callParent(arguments);return this.sync()},setTop:function(){this.callParent(arguments);return this.sync()},setLeftTop:function(){this.callParent(arguments);return this.sync()},setXY:function(b,f){callback=this.wrapCB_(f);if(f&&a.isPlainObject(f))f.onEnd=callback;this.fixDisplay();this.beforeAction_();this.callParent([b,f]);f||callback();return this},wrapCB_:function(b){var f=this;if(b&&a.isPlainObject(b))b=b.onEnd;return function(){f.constrainXY();
f.sync(false);b&&a.isFunction(b)&&b()}},setSize:function(b,f,c){var g;g=this.wrapCB_(c);if(c&&a.isPlainObject(c))c.onEnd=g;this.beforeAction_();this.callParent([b,f,c]);c||g();return this},setWidth:function(b,f){var c;c=this.wrapCB_(f);if(f&&a.isPlainObject(f))f.onEnd=c;this.beforeAction_();this.callParent([b,f]);f||c();return this},setHeight:function(b,f){var c;c=this.wrapCB_(f);if(f&&a.isPlainObject(f))f.onEnd=c;this.beforeAction_();this.callParent([b,f]);f||c();return this},setZIndex:function(b){this.zindex=
b;this.getShim()&&this.shim.setStyle("z-index:"+b++);return this.setStyle("z-index:"+b)}})});
MT.mtClass("MT.util.ElementCt",{childEls:[],constructor:function(){var a;if(this.hasOwnProperty("childEls")){a=this.childEls;delete this.childEls;this.addChildEls.apply(this,a)}},getChildEls_:function(){var a;if(this.hasOwnProperty("childEls")||this.childEls)return this.childEls;a=this.self;if(a.$childEls)return a.$childEls;if((a=a.prototype)&&a.hasOwnProperty("childEls"))return a.childEls;return[]},destroy:function(){var a=this.getChildEls_(),d,e,b;for(b=a.length-1;b>=0;b--){e=a[b];if(typeof e!=
"string")e=e.name;if(d=this.childCt[e]){this.childCt[e]=null;d.remove()}}},addChildEls:function(){var a=arguments;if(this.hasOwnProperty("childEls"))this.childEls.push.apply(this.childEls,a);else this.childEls=this.getChildEls_().concat(Array.prototype.slice.call(a));this.childEls=MT.array.unique(this.childEls)},applyChildEls:function(a,d){var e=this.getChildEls_(),b,f,c,g;if(!this.childCt)this.childCt={};b=(d||this.id)+"-";for(c=e.length-1;c>=0;c--){f=e[c];if(typeof f==="string")g=MT.getDom(b+f);
else{g=MT.getDom(f.id||b+f.itemId||f.selector);f=f.name}this.childCt[f]=MT.get(g)}},removeChildEls:function(a){var d=this.getChildEls_(),e=this.childEls=[],b,f,c;f=0;for(b=d.length;f<b;++f){c=d[f];if(a(c)){c=MT.isString(c)?c:c.name;this.childCt[c]=null;delete this.childCt[c]}else e.push(c)}}});
MT.mtClass("MT.ui.ZIndexMgr",{statics:{zBase:9E3},constructor:function(a){var d=this,e=MT;d.list={};d.zIndexStack=[];d.front=null;if(a)if(a.isContainer){a.on("resize",d._onContainerResize,d);d.zseed=e.number.parse(d.rendered?a.getNode().getStyle("zIndex"):undefined,d.getNextSeed());d.targetEl=a.getTargetEl();d.container=a}else{e.on(e.Config.win,"resize",e.func.bind(d._onContainerResize,d));d.zseed=d.getNextSeed();d.targetEl=e.get(a)}else{e.on(e.Config.win,"resize",e.func.bind(d._onContainerResize,
d));d.zseed=d.getNextSeed();e.ready(function(){d.targetEl=e.dom.getBody().tag})}},getNextSeed:function(){return MT.ui.ZIndexMgr.zBase+=1E4},setBase:function(a){this.zseed=a;a=this.assignZIndices();this._activateLast();return a},assignZIndices:function(){for(var a=this.zIndexStack,d=a.length,e=0,b=this.zseed,f;e<d;e++)if((f=a[e])&&f.visible)b=f.setZIndex(b);this._activateLast();return b},_setActiveChild:function(a,d){var e=this.front;if(a!==e){e&&!e.destroying&&e.setActive(false,a);if(a&&a!=d){a.setActive(true);
a.modal&&this._showModalMask(a)}}},onComponentHide:function(a){a.setActive(false);this._activateLast()},_activateLast:function(){var a=this.zIndexStack,d=a.length-1,e=this.front,b;for(this.front=undefined;d>=0&&!a[d].visible;--d)if(b=a[d]){this._setActiveChild(b,e);if(b.visible&&b.modal)return}for(;d>=0;--d){b=a[d];if(b.isVisible()&&b.modal){this._showModalMask(b);return}}this._hideModalMask()},_showModalMask:function(a){var d=a.node.getStyle("zIndex")-4,e=a.getFloatParent();a=e?e.getTargetEl():a.container;
e=a.getBound();var b=MT,f=b.Config.doc;if(a.tag===f.body){e.height=Math.max(f.body.scrollHeight,b.dom.getDocumentHeight());e.width=Math.max(f.body.scrollWidth,e.width)}if(!this.mask){this.mask=b.get(f.body).createChild({"class":b.cssPrefix+"mask"});this.mask.setDisplayMode(b.Element.DISPLAY);this.mask.on("click",b.func.bind(this._onMaskClick,this))}this.mask.maskTarget=a;a.addClass(b.cssPrefix+"body-masked");this.mask.setStyle("zIndex:"+d);this.mask.show();this.mask.setBox(e)},_hideModalMask:function(){var a=
this.mask;if(a&&a.isVisible()){a.maskTarget.removeClass(MT.cssPrefix+"body-masked");a.maskTarget=undefined;a.hide()}},_onMaskClick:function(){this.front&&this.front.focus()},_onContainerResize:function(){var a=this.mask,d,e=MT.Config.doc;if(a&&a.isVisible()){a.hide();d=a.maskTarget;d=d.tag===e.body?{height:Math.max(e.body.scrollHeight,MT.dom.getDocumentHeight()),width:Math.max(e.body.scrollWidth,e.documentElement.clientWidth)}:d.getViewSize(true);a.setSize(d);a.show()}},register:function(a){a.zIndexManager&&
a.zIndexManager.unregister(a);a.zIndexManager=this;this.list[a.id]=a;this.zIndexStack.push(a);a.on("hide",this.onComponentHide,this)},unregister:function(a){var d=this.list;delete a.zIndexManager;if(d&&d[a.id]){delete d[a.id];a.off("hide",this.onComponentHide);MT.array.remove(this.zIndexStack,a);this._activateLast()}},get:function(a){return a.isComp?a:this.list[a]},bringToFront:function(a){var d=false,e=this.zIndexStack;a=this.get(a);if(a.visible&&a!==this.front){MT.array.remove(e,a);a.preventBringToFront?
e.unshift(a):e.push(a);this.assignZIndices();d=true;this.front=a}d&&a.visible&&a.modal&&this._showModalMask(a);return d},sendToBack:function(a){a=this.get(a);MT.array.remove(this.zIndexStack,a);this.zIndexStack.unshift(a);this.assignZIndices();this._activateLast();return a},hideAll:function(){var a=this.list,d,e;for(e in a)if(a.hasOwnProperty(e)){d=a[e];d.isComp&&d.isVisible()&&d.hide()}},hide:function(){var a=this.mask,d=0,e=this.zIndexStack,b=e.length,f;for(this.tempHidden=[];d<b;d++){f=e[d];if(f.isVisible()){this.tempHidden.push(f);
f.node.hide()}}a&&a.hide()},show:function(){for(var a=0,d=this.tempHidden,e=this.mask,b=d?d.length:0,f;a<b;a++){f=d[a];f.node.show();f.setPosition(f.x,f.y)}this.tempHidden.length=0;if(e){e.show();e.alignTo(e.maskTarget,"tl-tl")}},getActive:function(){return this.front},getBy:function(a,d){for(var e=[],b=0,f=this.zIndexStack,c=f.length,g;b<c;b++){g=f[b];if(a.call(d||g,g)!==false)e.push(g)}return e},each:function(a,d){var e=this.list,b,f;for(b in e)if(e.hasOwnProperty(b)){f=e[b];if(f.isComp&&a.call(d||
f,f)===false)break}},eachBottomUp:function(a,d){for(var e=this.zIndexStack,b=0,f=e.length,c;b<f;b++){c=e[b];if(c.isComp&&a.call(d||c,c)===false)break}},eachTopDown:function(a,d){for(var e=this.zIndexStack,b=e.length,f;b-- >0;){f=e[b];if(f.isComp&&a.call(d||f,f)===false)break}},destroy:function(){var a=this.list,d,e;for(e in a)if(a.hasOwnProperty(e)){d=a[e];d.isComp&&d.destroy()}delete this.zIndexStack;delete this.list;delete this.container;delete this.targetEl}},function(){MT.WindowMgr=new this});
MT.mtClass("MT.util.Floating",{focusOnToFront:true,constructor:function(a){this.node=new MT.Layer(MT.mixin({id:this.id,hideMode:this.hideMode,hidden:!this.visible,constrain:false,shim:this.shim===false?false:undefined,node:a},this.floating,true));this.floating=true;this.registerWithOwnerCt()},registerWithOwnerCt:function(){var a;this.zIndexParent&&this.zIndexParent.unregisterFloatingItem(this);for(a=this.getParent();a;){if(a.floating)break;a=a.getParent()}this.zIndexParent=a;if(this.registerWithManager!==
false)this.zIndexParent?this.zIndexParent.registerFloatingItem(this):MT.WindowMgr.register(this)},setZIndex:function(a){var d=this.loadMask;this.node.setZIndex(a);if(d&&d.onZIndexChange)d.onZIndexChange(a);a+=10;if(this.floatingItems)a=Math.floor(this.floatingItems.setBase(a)/100)*100+1E4;return a},alignTo:function(a,d,e){this.setPagePosition(this.node.getAlignToXY(a.tag||a,d,e));return this},toFront:function(a){this.zIndexParent&&this.bringParentToFront!==false&&this.zIndexParent.toFront(true);if(MT.isUndefined(a))a=
!this.focusOnToFront;if(a)this.preventFocusOnActivate=true;if(this.zIndexManager.bringToFront(this))a||this.focus();delete this.preventFocusOnActivate;return this},setActive:function(a){if(a){this.modal&&!this.preventFocusOnActivate&&this.focus();this.fire("activate",this)}else this.fire("deactivate",this)},toBack:function(){this.zIndexManager.sendToBack(this);return this},center:function(){var a;if(this.isVisible()){a=this.node.getAlignToXY(this.container,"c-c");this.setPagePosition(a)}else this.needsCenter=
true;return this},onFloatShow:function(){this.needsCenter&&this.center();delete this.needsCenter},fitContainer:function(){var a=this.getFloatParent();this.setSize((a?a.getTargetEl():this.container).getViewSize(false))},doConstrain:function(a){var d=this.getNode(),e=this.getParent();a=a||e&&e.getTargetEl()||this.container;if(d=d.getConstrainVector(a)){a=this.getPosition();a[0]+=d[0];a[1]+=d[1];this.setPosition(a)}return this}});
MT.mtClass("MT.ui.CompLoader",{$extend:"MT.ElemLoader",target:null,loadMask:false,isLoader:true,setTarget:function(a){this.target&&this.target!=a&&this.abort();this.target=a},Renderers:{Html:function(a,d){a.getTarget().update(d);return true}},addMask:function(a){this.target.setLoading(a)},removeMask:function(){this.target.setLoading(false)}});
MT.mtClass("MT.ui.AbstractComponent",{mixins:{elCt:"MT.util.ElementCt",evtag:MT.events.EventTarget},statics:{INC_ID:1E3,_instances:{}},isComp:true,autoShow:false,baseCls:MT.cssPrefix+"widget",disableCls:MT.cssPrefix+"item-disabled",visible:true,focused:false,disabled:false,draggable:false,maskOnDisable:true,ui:"default",uiCls:[],renderTpl:null,rendered:false,floating:false,hideMode:"display",defUnit:"px",mType:"component",constructor:function(a){this.initConfig=a=a||{};MT.events.EventTarget.call(this);
this.mixins.elCt.constructor.call(this);this.initializer(a);MT.ui.AbstractComponent._instances[this.getId()]||(MT.ui.AbstractComponent._instances[this.getId()]=this);this.loader=this.getLoader();this.renderTo&&this.render(this.renderTo);this.autoShow&&this.show()},initializer:function(a){MT.mixin(this,a,true);this.getId();this.renderData=this.renderData||{};this.dh=this.dh||MT.q;this.setSize(this.width,this.height)},getId:function(){var a=this.mType?this.mType+"-":"comp-";return this.id||(this.id=
a+ ++MT.ui.AbstractComponent.INC_ID)},set:MT.func.setter(function(a,d){if(MT.isFunction(this[a]))this[a](d);else if(MT.isFunction(this["set"+MT.string.capitalFirst(a)]))this["set"+MT.string.capitalFirst(a)](d);else this[a]=d}),tpl:null,tplMode:"overwrite",getTpl:function(a){if(a&&this[a]){this[a]=MT.Template(this[a],this.getId());return this[a]}return null},setUi:function(a){var d=this.baseCls+"-",e=d+this.ui,b=d+a;this.uiCls.push(this.baseCls);this.uiCls.push(e);this.ui=a;if(this.uiCls.length){this.removeCls(this.uiCls.join(" "));
this.uiCls=MT.array.unique(this.uiCls);this.uiCls=MT.array.map(this.uiCls,function(f){if(f)f=f.replace(e,b);return f});this.addCls(this.uiCls.join(" "))}},addCls:function(a){this.node&&this.rendered&&this.node.addClass(a);return this},removeCls:function(a){this.node&&this.rendered&&this.node.removeClass(a);return this},addUiCls:function(a){this.addCls(this.mapCls_(a).join(" "))},removeUiCls:function(a){this.removeCls(this.mapCls_(a,true).join(" "))},mapCls_:function(a,d){var e=[],b=this;if(MT.isArray(a))e=
a;else if(MT.isString(a))e=a.split(" ");return e=MT.array.map(e,function(f){var c=b.baseCls+"-"+f;c=c+" "+(b.baseCls+"-"+b.ui+"-"+f);f=b.hasUiCls_(c);if(d&&f)MT.array.remove(b.uiCls,c);else if(f)c="";else b.uiCls.push(c);return c},b)},hasUiCls_:function(a){return MT.array.indexOf(a,this.uiCls||[])===-1?false:true},setVisible:function(a){return this[a?"show":"hide"]()},onShow:function(){},onHide:function(){},isVisible:function(a){var d=this.visible,e=this._parent;if(this.destroyed)return false;if(a&&
d&&this.rendered&&e)for(;e;){if(!e.visible||e.collapsed){d=false;break}e=e._parent}return d},setDisabled:function(a){return this[a?"disable":"enable"]()},enable:function(a){this.removeCls(this.disableCls);if(this.rendered)this.onEnable();this.disabled=false;a!==true&&this.fire("enable",this);return this},onEnable:function(){if(this.maskOnDisable){this.getNode().tag.disabled=false;this.unmask()}},disable:function(a){this.addCls(this.disableCls);if(this.rendered)this.onDisable();this.disabled=true;
a!==true&&this.fire("disable",this);return this},onDisable:function(){if(this.maskOnDisable){this.getNode().tag.disabled=true;this.mask()}},mask:function(){var a=this.getNode();a&&a.mask.apply(a,arguments)},unmask:function(){var a=this.getNode();a&&a.unmask()},addOverCls:function(){this.disabled||this.node.addClass(this.overCls)},removeOverCls:function(){this.node.removeClass(this.overCls)},setSize:function(a,d){var e=this.getNode(),b=MT;if(b.isObject(a)){d=a.height;a=a.width}if(b.isNumber(a))this.width=
b.number.clamp(a,this.minWidth,this.maxWidth);if(b.isNumber(d))this.height=b.number.clamp(d,this.minHeight,this.maxHeight);if(this.rendered){a&&e.setStyle("width:"+b.dom.addUnits(a,this.defUnit));d&&e.setStyle("height:"+b.dom.addUnits(d,this.defUnit))}return this},setWidth:function(a){this.setSize(a)},setHeight:function(a){this.setSize(undefined,a)},getSize:function(a){if(this.rendered)return this.getNode().getSize(a||0)},setModel:function(a){this.model_=a},getModel:function(){return this.model_},
update:function(a,d,e){var b="";b=MT;d=this.getTargetEl();if(this.tpl&&!b.isString(a)){this.setModel(a);if(this.rendered){b=this.tpl.render(a||{},this);d[this.tplMode==="overwrite"?"html":this.tplMode](b)}}else{this.html=b.isArray(a)?a.join(""):a;if(this.rendered&&b.isString(this.html)){d.html(this.html);delete this.html;e&&b.isFunction(e)&&e.call(this)}}return this},initCt_:function(a){if(!a&&this.node)a=this.node.tag.parentNode;return this.container=a.tag?a:MT.get(a)},beforeRender:function(){this.setUi(this.ui)},
getRender:function(){this.beforeRender();if(this.fire("beforerender",this)!==false){if(this.node)return{tag:"<div></div>",id:"comp-"+ ++MT.AbstractComponent.INC_ID};return this.initElCfg_()}return null},initElCfg_:function(){var a=this.autoEl,d={tag:"<div></div>",id:this.id,tpl:this.getTpl("renderTpl")};if(MT.isString(a))d.tag=a;else MT.mixin(d,a,true);if(d.tpl)d.tplData=this.initRenderData_();return d},initRenderData_:function(){return MT.mixin({id:this.id,ui:this.ui,uiCls:this.uiCls,baseCls:this.baseCls,
compCls:this.compCls},this.renderData)},getInsertPosition_:function(a){if(a!==undefined)a=MT.isNumber(a)?this.container.tag.childNodes[a]:MT.getDom(a);return a},render:function(a){var d=this.node&&(this.node=MT.get(this.node)),e;e=this.renderPos;a=this.initCt_(a);e=this.getInsertPosition_(e);if(d){this.fromDoc=true;this.initStyles(d);e?a.tag.insertBefore(d.tag,e):a.tag.appendChild(d.tag)}else{this.fromDoc=false;d=this.getRender();d=MT.dom.applyMarkup(d);if(e){d=MT.q(d).insertBefore(e);d=d[0]}else a.tag.appendChild(d);
this.wrapPrimaryEl(d);this.initStyles(this.node)}if(!this.container)this.container=MT.get(this.node.tag.parentNode);this.ctCls&&this.container.addClass(this.ctCls);this.onRender(this.container);a=this.getTargetEl();this.node.setDisplayMode(MT.Element[this.hideMode.toUpperCase()]);this.compCls&&this.node.addClass(this.compCls);this.overCls&&this.node.hover(this.addOverCls,this.removeOverCls,this);this.fire("render",this);if(this.contentEl){pre=MT.cssPrefix;hide=pre+"hide-";contentEl=MT.get(this.contentEl);
contentEl.removeClass([pre+"hidden",hide+"display",hide+"offsets",hide+"nosize"].join(" "));a.tag.appendChild(contentEl.tag)}this.afterRender();this.fire("afterrender",this);this.bindUI();this.visible||this.node.hide()},wrapPrimaryEl:function(a){this.node=MT.get(a)},doAutoRender:function(){var a=MT.Config.doc;this.rendered||(this.floating?this.render(a.body):this.render(MT.isBoolean(this.autoRender)?MT.get(a.body):this.autoRender))},onRender:function(){var a=this.x,d=this.y,e={};this.applyChildEls(this.node);
this.rendered=true;if(a!==undefined)e.x=a;if(d!==undefined)e.y=d;width=this.width;height=this.height;if(typeof width=="number")e.width=width;if(typeof height=="number")e.height=height;this.lastBox=e},afterRender:function(){this.fitCt||this.maximized?this.fitContainer():this.setSize(this.width,this.height);this.disabled&&this.disable(true)},initStyles:function(a){if(this.cls){if(MT.isArray(this.cls))this.cls=this.cls.join(" ");a.addClass(this.cls);delete this.cls}if(this.style){a.setStyle(this.style);
delete this.style}},bindUI:function(){this.addFocusListeners_()},registerFloatingItem:function(a){if(!this.floatingItems)this.floatingItems=new MT.ZIndexMgr(this);this.floatingItems.register(a)},unregisterFloatingItem:function(a){this.floatingItems&&this.floatingItems.unregister(a)},addFocusListeners_:function(){var a=this.getFocusEl(),d=MT.func;if(a){if(a.isComp)return a.addFocusListeners_();if(a.needsTabIndex())a.tag.tabindex=-1;a.on("focus",d.bind(this.onFocus,this));a.on("blur",d.bind(this.onBlur,
this))}},preFocus:MT.noop,onFocus:function(a){var d=this.focusCls,e=this.getFocusEl();if(!this.disabled){this.preFocus(a);d&&e&&e.addClass(this.mapCls_(d).join(" "));if(!this.hasFocus){this.hasFocus=true;this.fire("focus",[this,a])}}},beforeBlur:MT.noop,onBlur:function(a){var d=this.focusCls,e=this.getFocusEl();if(!this.destroying){this.beforeBlur(a);d&&e&&e.removeClass(this.mapCls_(d).join(" "));this.validateOnBlur&&this.validate();this.hasFocus=false;this.fire("blur",[this,a]);this.postBlur(a)}},
postBlur:MT.noop,getNode:function(){return this.node},getTargetEl:function(){return this.node},getContentEl:function(){return this.node},getFocusEl:MT.noop,setParent:function(a){if(this==a)throw Error("can't set parent as itself!");if(a&&this._parent&&this.id_&&this._parent._getChild(this.id_)&&this._parent!=a)throw Error("this comp is already the child of some parent.");this._parent=a},getParent:function(){return this._parent},addChild:function(a){this.addChildAt(a,this.getChildLen())},getChildLen:function(){return this.children_?
this.children_.length:0},addChildAt:function(a,d){if(d<0||d>this.getChildLen())throw Error("children out of bound.");if(!this.childIndex_||!this.children_){this.childIndex_={};this.children_=[]}a.getParent()==this&&MT.array.remove(this.children_,a);this.childIndex_[a.getId()]=a;a.setParent(this);this.children_.splice(d,0,a);a.onAdded(this,d)},getChildren:function(){return this.children_?this.children_:[]},getChild:function(a){return this.childIndex_&&a?this.childIndex_[a]:null},getChildAt:function(a){return this.children_?
this.children_[a]:null},indexOfChild:function(a){return this.children_&&a?MT.array.indexOf(a,this.children_):-1},eachChild:function(a,d){this.children_&&this.children_.length&&MT.each(this.children_,a,d)},removeChild:function(a){if(!a)throw Error("unknown child.");var d=MT.isString(a)?a:a.getId();a=this.getChild(d);if(d&&a){this.childIndex_[d]&&delete this.childIndex_[d];MT.array.remove(this.children_,a);a.onRemoved(this);a.setParent(null)}return a},removeChildAt:function(a){return this.removeChild(this.getChildAt(a))},
removeChildren:function(){var a=this.children_,d;if(a&&a.length)for(d=0;d<a.length;d++)this.removeChild(a[d])},onAdded:MT.noop,onRemoved:MT.noop,beforeDestroy:MT.noop,onResize:MT.noop,destroy:function(){var a=this.getId();if(!this.destroyed)if(this.fire("beforedestroy",this)!==false){this.destroying=true;this.beforeDestroy();this.floating&&this.zIndexManager&&this.zIndexManager.unregister(this);this.onDestroy();this.fire("destroy",this);MT.ui.AbstractComponent._instances[a]&&delete MT.ui.AbstractComponent._instances[a];
MT.off(this);if(this.rendered){this.eachChild(function(d){d.getParent();d.destroy()});this.mixins.elCt.destroy.call(this);this.node.remove();delete this.node;delete this.rendered}this.childIndex_=this.children_=null;if(this.state_){this.state_.clear();delete this.state_}this._parent=this.model_=null;this.parentComp&&delete this.parentComp;this.destroying=false;this.destroyed=true}},onDestroy:function(){this.floatingItems&&this.floatingItems.destroy()},addState:function(a,d){if(!this.state_)this.state_=
new MT.util.HashMap;this.state_.add(a,d);return this},getState:function(a){return this.state_?this.state_.get(a):null},removeState:function(a){this.state_&&this.state_.removeByKey(a);return this},setPosition:function(a,d,e){var b=this.beforeSetPosition.apply(this,arguments),f=this.getNode();if(b&&this.rendered){b=this.convertPosition(b);if(e){if(MT.isBoolean(e))e={};this.node.animate(MT.mixin({duration:1,onEnd:MT.func.bind(this.afterSetPosition,this,[b.left,b.top]),to:b},e))}else{if(b.left!==undefined&&
b.top!==undefined)f.setLeftTop(b.left,b.top);else if(b.left!==undefined)f.setLeft(b.left);else b.top!==undefined&&f.setTop(b.top);this.afterSetPosition(b.left,b.top)}}return this},beforeSetPosition:function(a,d,e){var b;a=!a||MT.isNumber(a)?{x:a,y:d,anim:e}:MT.isNumber(b=a[0])?{x:b,y:a[1],anim:d}:{x:a.x,y:a.y,anim:d};a.hasX=MT.isNumber(a.x);a.hasY=MT.isNumber(a.y);this.x=a.x;this.y=a.y;return a.hasX||a.hasY?a:null},afterSetPosition:function(a,d){this.onPosition(a,d);this.fire("move",[this,a,d])},
convertPosition:function(a,d){var e={};if(a.hasX)e.left=d?MT.dom.addUnits(a.x):a.x;if(a.hasY)e.top=d?MT.dom.addUnits(a.y):a.y;return e},onPosition:MT.noop,getOverflow:function(){var a=null;if(typeof this.autoScroll=="boolean")a={overflow:this.autoScroll?"auto":""};else if(this.overflowX!==undefined||this.overflowY!==undefined)a={"overflow-x":this.overflowX||"","overflow-y":this.overflowY||""};if(a&&(MT.ua.ie6||MT.ua.ie&&MT.ua.isVersion(7)))a.position="relative";return a},getFloatParent:function(){var a=
this.getParent();if(a&&a.floating)return a;return null},upLayout:function(a,d){a&&a.setStyle(d)},getLoader:function(){var a=this.autoLoad?MT.isObject(this.autoLoad)?this.autoLoad:{url:this.autoLoad}:null,d=this.loader||a;if(d){if(d.isLoader)d.setTarget(this);else this.loader=new MT.ui.CompLoader(MT.mixin({target:this,autoLoad:a},d));return this.loader}return null}},function(){MT.CompMgr={get:function(a){if(MT.isString(a))return MT.ui.AbstractComponent._instances[a];return a}}});
MT.mtClass("MT.ui.Component",{$extend:"MT.ui.AbstractComponent",mixins:{floating:"MT.util.Floating"},statics:{DIRECTION_TOP:"top",DIRECTION_RIGHT:"right",DIRECTION_BOTTOM:"bottom",DIRECTION_LEFT:"left",VERTICAL_DIRECTION_Re:/^(?:top|bottom)$/,INVALID_ID_CHARS_Re:/[\.,\s]/g},resizeHandles:"all",floating:false,toFrontOnShow:true,hideMode:"display",constructor:function(a){a=a||{};if(a.tagName||a.tag||MT.isString(a))a={applyTo:a,id:a.id||a};this.callParent(arguments)},initializer:function(){var a,d=this.listeners;
this.callParent(arguments);if(d){for(a in d)this.on(a,d[a],this);this.listeners=null}},afterRender:function(){this.setUi(this.ui);this.callParent();if(!(this.x&&this.y)&&(this.pageX||this.pageY))this.setPagePosition_({x:this.pageX,y:this.pageY});this.resizable&&this.initResizable(this.resizable);this.draggable&&this.initDraggable();this.autoScroll&&this.setAutoScroll(true);this.update(this.html);this.useProxy&&this.getProxy();this.dock&&this.setDock(this.dock);this.focus()},beforeRender:function(){var a=
this.floating;this.uiCls=[];if(a){this.addCls(MT.cssPrefix+"layer");(a=a.cls)&&this.addClass(a)}return this.callParent()},makeFloating_:function(a){this.mixins.floating.constructor.call(this,a)},wrapPrimaryEl:function(a){this.floating?this.makeFloating_(a):this.callParent(arguments)},initResizable:function(a){a=MT.mixin({node:this.node,dynamic:false,handles:this.resizeHandles||"all"},a);a.resizeTarget=this;this.resizer=new MT.Resizer(a)},getDragEl:function(){return this.node},initDraggable:function(){var a=
this.indicateDragCls||MT.cssPrefix+"widget-draggable",d=MT.mixin({clickPixelThresh:0,clickTimeThresh:0,useShim:true,move:false,haltDown:false,dragNode:this.getDragEl(),dragTarget:this},this.ddConfig||{},true);this.delegate=new MT.dd.Delegate({bubbleTargets:this,container:this.node,dragConfig:d,nodes:"."+a,target:false})},scrollBy:function(){var a;if((a=this.getNode())&&a.tag)a.scrollBy.apply(a,arguments)},showAt:function(a,d,e){if(!this.rendered&&(this.autoRender||this.floating))this.doAutoRender();
this.floating?this.setPosition(a,d,e):this.setPagePosition(a,d,e);this.show()},setAutoScroll:function(a){this.autoScroll=!!a;if(this.rendered){a=this.getTargetEl();a.setStyle(this.getOverflow())}return this},setPagePosition:function(a,d,e){var b={};if(MT.isArray(a)){d=a[1];a=a[0]}this.pageX=a;this.pageY=d;if(this.floating)this.setPosition(a,d,e);else{b.left=a;b.top=d;this.setPosition(b.left,b.top,e)}return this},updateBox:function(a){this.setSize(a.width,a.height);this.setPagePosition(a.x,a.y);return this},
show:function(){if(this.rendered&&this.isVisible()){if(this.toFrontOnShow&&this.floating){this.toFront();if(!this.onFirstShow){this.onFirstShow=true;this.onShow.apply(this,arguments);this.afterShow.apply(this,arguments)}}}else if(this.fire("beforeshow",this)!==false){this.visible=true;if(!this.rendered&&(this.autoRender||this.floating))this.doAutoRender();if(this.rendered){this.beforeShow();this.onShow.apply(this,arguments);this.afterShow.apply(this,arguments)}}return this},beforeShow:MT.noop,onShow:function(){this.node.show();
this.callParent(arguments);this.floating&&this.constrain&&this.doConstrain(this.constrainTo)},afterShow:function(a,d,e){a=a||this.animateTarget;this.ghost||(a=null);if(!a)this.onShowComplete(d,e)},onShowComplete:function(a,d){if(this.floating){this.toFront();this.onFloatShow()}if(a)a.call(d||this);this.eachChild(function(e){if(e.floating&&e.showOnParentShow){delete e.showOnParentShow;e.show()}});this.fire("show",this)},hide:function(){this.showOnParentShow=false;if(!(this.rendered&&!this.isVisible())&&
this.fire("beforehide",this)!==false){this.visible=false;this.rendered&&this.onHide.apply(this,arguments)}return this},onHide:function(a,d,e){a=a||this.animateTarget;this.ghost||(a=null);this.node.hide();a||this.afterHide(d,e)},afterHide:function(a,d){MT.ui.AbstractComponent.prototype.onHide.call(this);if(a)a.call(d||this);this.eachChild(function(e){if(e.floating&&e.hideOnParentHide!==false&&e.isVisible()){e.hide();e.showOnParentShow=true}});this.fire("hide",this)},onDestroy:function(){if(this.rendered){this.proxy&&
this.proxy.remove();this.resizer&&this.resizer.dispose();this.delegate&&this.delegate.dispose()}this.callParent()},focus:function(){var a=this.getFocusEl(),d;if(this.rendered&&!this.destroyed&&a){if(a.isComp)return a.focus();if(d=a.tag){if(a.needsTabIndex())d.tabindex=-1;a.focus()}this.floating&&this.toFront(true)}return this},blur:function(){var a;if(this.rendered&&(a=this.getFocusEl()))a.blur();return this},getProxy:function(){var a;if(!this.proxy){a=MT.Config.doc.body;this.proxy=this.node.createProxy({"class":MT.cssPrefix+
"proxy-el"},a,true)}return this.proxy},setDock:function(a){var d=this.getNode(),e=MT.cssPrefix+"widget-docked";this.dock=a;e+=" "+MT.cssPrefix+"widget-docked-"+a;d.addClass(e)},setLoading:function(a,d){var e;if(this.rendered){if(this.loadMask){this.loadMask.destroy();this.loadMask=null}if(a!==false){e=MT.isObject(a)?MT.mixin({},a):MT.isString(a)?{msg:a}:{};d&&MT.mixin(e,{useTargetEl:true});this.loadMask=new MT.ui.LoadMask(this,e);this.loadMask.show()}}return this.loadMask},getPosition:function(a){var d=
this.node,e=this.getParent(),b=this.floating&&e;if(a===true||!b)return[d.getLeft(true),d.getTop(true)];if(this.x!==undefined&&this.y!==undefined)a=[this.x,this.y];else{a=d.getXY();if(b){e=e.getTargetEl().getRegion();a[0]-=e.left;a[1]-=e.top}}return a}});
MT.mtClass("MT.ui.LoadMask",{$extend:"MT.ui.Component",msg:"loading...",msgCls:MT.cssPrefix+"mask-loading",maskCls:MT.cssPrefix+"mask",isLoadMask:true,useMsg:true,useTargetEl:false,baseCls:MT.cssPrefix+"mask-msg",childEls:["msgEl"],focusOnToFront:false,registerWithManager:false,defaultZIndex:100,renderTpl:'<div id="${id}-msgEl" style="position:relative" class="${msgCls}"></div>',constructor:function(a,d){if(!a)throw Error("please check the input component is exist.@loadMask.js constructor");a.addChild(this);
this.bindToComp(a);d.renderTo=MT.Config.doc.body;this.callParent([d]);this.initializer(d)},initializer:function(){this.renderData={id:this.id,msgCls:this.msgCls};this.callParent(arguments)},bindToComp:function(a){var d=a.resizer;if(a.floating)a.on("move",this.resizeMask,this);else this.preventBringToFront=true;if(d)d.on("resize:end",this.resizeMask,this)},afterRender:function(){this.callParent();this.container=this.getParent().getContentEl();this.onBeforeLoad()},onBeforeLoad:function(){var a=this.getParent();
if(!this.disabled){this.loading=true;a.rendered&&a.isVisible(true)&&this.show()}},getMaskEl:function(){if(!this.maskEl)this.maskEl=MT.dom.getBody().createChild({"class":this.maskCls});return this.maskEl},show:function(){this.onShow();return this.callParent(arguments)},onShow:function(){var a=this.childCt.msgEl;this.loading=true;if(this.useMsg)a.show().html(this.msg);else a.tag.parentNode.style.display="none";this.callParent(arguments)},hide:function(){return this.callParent(arguments)},onHide:function(){this.callParent();
this.getMaskEl().hide()},resizeMask:function(){var a;if(this.rendered&&this.isVisible()){this.center();a=this.getMaskTarget();this.getMaskEl().show().setSize(a.getSize()).alignTo(a,"tl-tl")}},getMaskTarget:function(){var a=this.getParent();return this.useTargetEl?a.getTargetEl():a.getNode()},afterShow:function(){this.callParent(arguments);this.setupMask()},setupMask:function(){this.resizeMask();this.setupZIndexes()},toFront:MT.noop,setZIndex:function(a){if(this.rendered){this.getMaskEl().setStyle({"z-index":++a});
this.node.setStyle({"z-index":++a})}return a},onZIndexChange:function(a){this.setZIndex(a)},setupZIndexes:function(){var a=this.activeOwner;if(a=this.getParent()){a=a.getNode().getZIndex();if(isNaN(a))a=this.defaultZIndex}else a=this.defaultZIndex;this.setZIndex(a)},onLoad:function(){this.loading=false;this.hide()},onDestroy:function(){this.maskEl&&this.maskEl.remove();this.callParent()}});
MT.mtClass("MT.ui.Layout",{isLayout:true,statics:{layoutsByType:{},create:function(a,d){var e=this.layoutsByType,b,f,c;if(!a||typeof a==="string"){c=a||d;f={}}else if(a.isLayout)return a;else{f=a;c=a.type||d}if(!(b=e[c])){b="MT.ui.Layout."+MT.string.capitalFirst(c);b=MT.mtGetClass(b);e[c]=b}return new b(f)}},constructor:function(a){this.id="";MT.mixin(this,a||{})},beginLayout:MT.noop});
MT.mtClass("MT.ui.Layout.Container",{$extend:"MT.ui.Layout",innerCls:MT.cssPrefix+"widget-inner",itemCls:MT.cssPrefix+"widget-item",type:"box",defMargin:2,margin:null,padding:0,pack:"left",layPos:"abs",constructor:function(a){MT.mixin(this,a,true);this.hov=this.hov||"h";this.margin=MT.isNumber(this.margin)?this.margin:this.defMargin;this.id=this.comp?this.comp.id:this.node?this.node.tag.id:MT.guid("mtpre-");this.maxWH={width:0,height:0};this.layouts=[];this.packDis={left:0,right:0,top:0,bottom:0};
this.dockDis={left:0,right:0,top:0,bottom:0}},doLayout:function(){var a=this.comp,d=this.hov!="h"?"v":"h";if(a.isContainer&&!this.noLayout){this.getCtSize();this.getChildren();if(a.beforeLayout&&a.beforeLayout.call(a,this)===false)MT.console({type:"warning",msg:"stop layout"});else{this.beginLayout(a,d);a.afterLayout&&a.afterLayout.call(a,this)}}},beginLayout:function(a,d){d==="h"?this.layoutItem(a,["left","right","top","bottom","center"],false):this.layoutItem(a,["top","bottom","left","right","middle"],
true)},reLayout:function(){this.maxWH={width:0,height:0};this.layouts=[];this.packDis={left:0,right:0,top:0,bottom:0};this.dockDis={left:0,right:0,top:0,bottom:0};this.doLayout()},getCt:function(){var a=this.comp;return a?a.getNode():MT.get(this.node)},getCtSize:function(){return this.size=this.getCt().getSize(0)},getChildren:function(){var a=this,d,e;a.packStack={};d=a.comp.getChildren()||[];MT.array.map(d,function(b){if(!b.noLayout&&!b.isLoadMask){e=b.pack||b.dock||a.pack;if(typeof a.packStack[e]==
"undefined")a.packStack[e]=[];e&&a.packStack[e].push(b)}})},layoutItem:function(a,d,e){var b=this,f,c,g,h,i,j=b.packStack,k,l,n,m=false,o,p=0,r=0;for(h=(h=a.childCt)?h.innerCt:h.body||a.getNode();f=d[r];++r){c=j[f];MT.each(c,function(q,s){if(q.visible&&!q.floating){b.fixComp(q,f,false,e);if(f!="center"){g=q.getNode();n=b.createStyle(a,g,f,q,s,e);g.addClass(b.itemCls+"-"+f);g.setStyle(n)}else if(!m&&f=="center"){m=true;h&&h.setStyle("text-align:center")}}},b)}b.fixComp(a,null,true,e);if(h)p=h.innerHeight();
k=b.maxWH.width;for(r=0;f=d[r];++r){c=j[f];MT.each(c,function(q){if(q.visible){g=q.getNode();if(e&&!a.isPanel&&!q.width){pb=b.getPadBor(g);i=q.childCt;i=q.isButton?i.btnEl:i.innerCt||g;l=k-pb.plr-pb.blr;if(q.isSeparator)l-=8;i.setStyle({width:l+"px"})}o=q.height||q.minHeight||0;!e&&h&&o>0&&p>o&&q.node.setStyle("marginTop:"+Math.round((p-o)/2)+"px")}},b)}b.doCalcChild(a,e)},createStyle:function(a,d,e,b,f,c){var g=e,h=this.maxWH,i,j=this.dockDis,k=this.packDis;d=d.getSize(2);if(c&&h.width<d.width)h.width=
d.width;else if(!c&&h.height<d.height)h.height=d.height;c=c?d.height:d.width;switch(e){case "left":i="top:"+j.top+"px;";j.left+=d.width;c=d.width;break;case "right":i="top:"+j.top+"px;";j.right+=d.width;c=d.width;break;case "top":i="left:"+j.left+"px;";j.top+=d.height;break;case "bottom":i="left:"+j.left+"px;";j.bottom+=d.height;break;case "center":g="left";break;case "middle":g="top"}e=k[g];if(!b.isContainer){e+=this.margin*f;if(b.mType==="menuSeparator"&&f>0)e-=2;if(a.isToolbar&&!b.isSeparator)e+=
2}k[g]+=parseInt(c,10);i+=g+":"+String(e)+"px;";return i},fixComp:function(a,d,e,b){if(a.isContainer){var f=this.size,c=this.maxWH,g=/^(?:top|bottom)$/i,h,i;i=a.getNode();var j=i.getSize(0);d=d||a.dock||this.pack;var k=a.childCt,l=this.dockDis,n=a.isPanel?2:0;i=this.getPadBor(i);if(k&&(h=k.innerCt||k.body)){d=g.test(d)?e?{height:c.height+"px"}:{width:f.width-i.plr-i.blr+"px"}:e?{width:c.width+"px"}:{height:f.height-i.ptb-i.btb-l.top-l.bottom-n+"px"};e=parseInt(d.height,10)||0;if(parseInt(d.width,
10)===0)d.width=f.width-i.plr-i.blr+"px";if(k.innerCt&&e>0&&j.height>e)d.top=Math.round((j.height-e)/2)+"px";if(e==0&&!b&&(a.height||a.minHeight))d.height=(a.height||a.minHeight)+"px";h.setStyle(d)}return i}},doCalcChild:function(a,d){var e,b,f,c=this.getCtSize(),g=d?c.height:c.width,h,i=MT,j=d?"offsetHeight":"offsetWidth",k=this.itemCls+"-";e=a.childCt.innerCt;var l=a.childCt.body,n=this.dockDis,m=d?n.top+n.bottom:n.left+n.right;if(e)if(!e.isStyle("text-align","center")){e=e.tag.childNodes;for(b=
0;b<e.length;b++){f=e[b];h=f.className;if(!i.string.contains(h,k))if(f[j]>g-m)(h=this.dockDisStyle(d,n,false,c))&&i.dom.setStyle(f,h)}}if(l)(h=this.dockDisStyle(d,n,true,c,this.getPadBor(l)))&&l.setStyle(h)},dockDisStyle:function(a,d,e,b,f){var c=this.margin,g={},h=d.left+d.right,i=d.top+d.bottom;if(e){if(d.top>0)g.top=d.top+"px";if(d.left>0)g.left=d.left+"px"}else if(a){if(d.top>0)g.top=d.top+c+"px";if(d.bottom>0)g["margin-bottom"]=d.bottom+c+"px"}else{if(d.left>0)g.left=d.left+c+"px";if(d.right>
0)g["margin-right"]=d.right+c+"px"}if(e){a=b.width-h-f.plr-f.blr;b=b.height-i-f.ptb-f.btb;if(a>0)g.width=a+"px";if(b>0)g.height=b+"px"}return g},getPadBor:function(a){var d=0,e=0,b=0,f=0,c=0,g=0;d=a.getBorderWidth("lr");e=a.getBorderWidth("tb");b=a.getPadding("lr");f=a.getPadding("tb");c=a.getMargin("lr");g=a.getMargin("tb");return{plr:b,ptb:f,blr:d,btb:e,mlr:c,mtb:g}},destroy:function(){MT.each(this.layouts,function(a){a.destroy()});this.layouts=[];delete this.packStack}});
MT.mtClass("MT.ui.Layout.Scroller",{$extend:"MT.ui.Layout.Container",scrollerCls:MT.cssPrefix+"box-scroller",beginLayout:function(a,d){this.doScroller(a,d==="h"?["left"]:["top"],d!="h")},doScroller:function(a,d,e){for(var b=this,f,c,g,h=a.childCt,i,j=b.maxWH,k,l,n=b.packStack,m,o,p=0,r;f=d[p];++p){c=n[f];r=0;MT.each(c,function(q,s){if(q.visible&&!q.floating){g=q.getNode();o=b.createStyle(a,g,f,q,s,e);g.addClass(b.itemCls+"-"+f);g.setStyle(o);r++}},b);r=(r-1)*b.margin;k=j.width;l=j.height;m=e?k:b.packDis.left+
r;l=e?b.packDis.top+r:l;a.iconSepEl&&a.iconSepEl.height(l);if(h){(i=h.innerCt)&&i.setSize(m,l);if(i=h.body){m+=i.getPadding("lr")+i.getBorderWidth("lr");l+=i.getPadding("tb")+i.getBorderWidth("tb")}}i=a.width||a.minWidth;a.setSize(i>m?undefined:m,l);MT.each(c,function(q){q.visible&&!q.floating&&q.getNode().width(k)},b)}},getOverflowCls:function(){return MT.cssPrefix+(me.hov==="h"?"horizontal":"vertical")+"-box-overflow-body"},getNames:function(){if(this.hov=="h")return{leftCap:"left",rightCap:"right"};
return{leftCap:"top",rightCap:"bottom"}},initBtnsCss:function(){var a=MT.cssPrefix,d=this.getNames(),e=d.leftCap;d=d.rightCap;var b=this.comp?this.comp.mType:"auto";this.preCtCls=this.preCtCls||a+"box-scroller-"+e;this.nextCtCls=this.nextCtCls||a+"box-scroller-"+d;this.preScrollerCls=this.preScrollerCls||a+b+"-scroll-"+e;this.nextScrollerCls=this.nextScrollerCls||a+b+"-scroll-"+d},getBtnCt:function(){var a=this.comp,d,e;if(a){d=a.getNode();if((e=a.childCt)&&e.body)d=e.body}return d||this.node},getPreBtn:function(){this.initBtnsCss();
var a=this.id+"-pre-scroller",d;if(!(d=this.checkBtnTag(a))){d=this.getBtnCt().createChild({"class":this.innerCls+" "+this.preCtCls},false,true);this.createInner_(d,a,this.preScrollerCls)}this.preBtn=d},createInner_:function(a,d,e){a.createChild({id:d,style:"display:none","class":this.scrollerCls+" "+e})},getNextBtn:function(){var a=this.id+"-next-scroller",d;if(!(d=this.checkBtnTag(a))){d=this.getBtnCt().createChild({"class":this.innerCls+" "+this.nextCtCls});this.createInner_(d,a,this.nextScrollerCls)}this.nextBtn=
d},checkBtnTag:function(a){if(a=MT.getDom(a))return MT.get(a);return false}});
MT.mtClass("MT.ui.Container",{$extend:"MT.ui.Component",defaultType:"panel",isContainer:true,baseCls:MT.cssPrefix+"container",innerCls:MT.cssPrefix+"widget-inner",constructor:function(a){this.callParent(arguments);this.initializer(a)},initializer:function(){this.callParent(arguments);if(!this.height&&this.minHeight)this.height=this.minHeight;if(!this.renderTo&&this.parentComp)this.renderTo=this.renderTo||this.parentComp.getNode();this.renderPos=this.renderPos;this.items=this.items||[]},addComp:function(a){var d=
MT;a=a?d.isArray(a)?a:[a]:this.items;var e=a.length,b,f,c;for(c=0;c<e;c++){b=a[c];if((f=b.mType)&&d.isString(f)){f=d.string.capitalFirst(f);delete b.mType;b=b||{};f=d.mtGetClass(f);if(d.isFunction(f)){b.parentComp=this;b=new f(b);this.addChild(b);this.itemCls&&b.addCls(this.itemCls)}}}return this},getChildByElement:function(a,d){var e,b,f=0,c=this.getChildren(),g=c.length;for(a=MT.getDom(a);f<g;f++){e=c[f];b=e.getNode();if(b.tag===a||b.contains(a))return d&&e.getChildByElement?e.getChildByElement(a,
d):e}return null},getFocusEl:function(){return this.getTargetEl()},afterRender:function(){this.callParent();this.addComp();this.ctMargin!==undefined&&this.getNode().setStyle({margin:MT.dom.addUnits(this.ctMargin)});this.layout=MT.mixin({comp:this},this.layout||{});this.layout=MT.ui.Layout.create(this.layout,"container");this.layout.doLayout()},onAdded:function(a,d){this.fire("added",[this,a,d])},onRemoved:function(a){this.fire("removed",[this,a])},beforeDestroy:function(){this.layout instanceof MT.ui.Layout&&
this.layout.destroy();this.callParent()}});
MT.mtClass("MT.ui.Button",{$extend:"MT.ui.Component",visible:true,disabled:false,pressed:false,baseCls:MT.cssPrefix+"btn",pressedCls:"pressed",overCls:"over",focusCls:"focus",textAlign:"center",mType:"button",clickEvent:"click",preventDefault:true,iconAlign:"left",scale:"small",arrowAlign:"right",arrowCls:"arrow",enableToggle:false,menuAlign:"tl-bl?",menuActiveCls:"menu-active",maskOnDisable:false,minHeight:22,handleMouseEvents:true,isButton:true,childEls:["btnEl","btnWrap","btnInnerEl","btnIconEl"],
renderTpl:['<em id="${id}-btnWrap"{#if splitCls} class="${splitCls}"{#/if}>',"{#if href }",'<a id="${id}-btnEl" href="${href}" class="${btnCls}" target="${hrefTarget}"{#if tabIndex} tabIndex="${tabIndex}"{#/if} role="link">','<span id="${id}-btnInnerEl" class="${baseCls}-inner">',"${label}","</span>",'<span id="${id}-btnIconEl" class="${baseCls}-icon ${iconCls}"{#if iconUrl} style="background-image:url(${iconUrl})"{#/if}></span>',"</a>","{#else}",'<button id="${id}-btnEl" type="${type}" class="${btnCls}" hidefocus="true"',
'{#if tabIndex} tabIndex="${tabIndex}"{#/if} role="button" autocomplete="off">','<span id="${id}-btnInnerEl" class="${baseCls}-inner" style="${innerSpanStyle}">',"${label}","</span>",'<span id="${id}-btnIconEl" class="${baseCls}-icon ${iconCls}"{#if iconUrl} style="background-image:url(${iconUrl})"{#/if}>&#160;</span>',"</button>","{#/if}","</em>","{#if closable}",'<a id="${id}-close" href="#" class="${baseCls}-close-btn" title="${closeText}"></a>',"{#/if}"],hrefTarget:"_blank",initializer:function(a){this.callParent(arguments);
if(!this.width&&a.minWidth)this.width=a.minWidth;if(!this.renderTo&&this.parentComp)this.renderTo=this.parentComp.childCt.body;if(this.menu){this.split=true;this.menu=MT.menu.Mgr.get(this.menu);this.menu.ownerButton=this;this.addChild(this.menu)}if(this.url)this.href=this.url;if(this.href&&!this.hasOwnProperty("preventDefault"))this.preventDefault=false;if(MT.isString(this.toggleGroup)&&this.toggleGroup!=="")this.enableToggle=true},getTplData_:function(){return{href:this.href,hrefTarget:this.hrefTarget,
type:this.mType,btnCls:this.align?this.baseCls+"-"+this.align:"",iconUrl:this.icon,iconCls:this.iconCls||"",label:this.label||"",tabIndex:this.tabIndex,innerSpanStyle:"",splitCls:this.split?this.baseCls+"-"+this.arrowCls+" "+(this.baseCls+"-"+this.arrowCls+"-"+this.arrowAlign):"",closable:this.closable,closeText:this.closeText}},setCompCls_:function(){var a=this.getCompCls_();if(!MT.isEmpty(this.oldCls)){this.removeUiCls(this.oldCls);this.removeUiCls(this.pressedCls)}this.oldCls=a;this.addUiCls(a)},
getCompCls_:function(){var a=[];if(this.iconCls||this.icon)this.label?a.push("icon-text-"+this.iconAlign):a.push("icon");else this.label&&a.push("noicon");this.pressed&&a.push(this.pressedCls);return a},beforeRender:function(){this.callParent();this.oldCls=this.getCompCls_();this.addUiCls(this.oldCls);MT.mixin(this.renderData,this.getTplData_());this.scale&&this.setScale(this.scale)},setScale:function(a){var d=this.ui.replace("-"+this.scale,""),e=this.parentComp;if(e&&e.resetChildUi)d+="-"+e.mType;
this.scale=a;this.setUi(d);return this},setUi:function(a){var d=this.scale;if(d&&!a.match(d))a=a+"-"+d;this.callParent([a]);return this},onRender:function(){var a,d=MT.func;this.callParent(arguments);this.split&&this.arrowTooltip&&this.arrowEl.tag.setAttribute("title",this.arrowTooltip);a=this.node;this.tooltip&&this.setTooltip(this.tooltip,true);if(this.handleMouseEvents){a.on("mouseenter",d.bind(this.onMouseOver_,this));a.on("mouseleave",d.bind(this.onMouseOut_,this));a.on("mousedown",d.bind(this.onMouseDown_,
this));if(this.split)a.on("mousemove",d.bind(this.onMouseMove_,this));a.on("mouseup",d.bind(this.onMouseUp_,this))}if(this.menu){this.menu.on("show",this.onMenuShow,this);this.menu.on("hide",this.onMenuHide,this)}a.on(this.clickEvent,d.bind(this.onClick_,this));MT.BtnToggleMgr.register(this)},onClick_:function(a){if(this.preventDefault||this.disabled&&this.href&&a)a.preventDefault();if(a.button===0)if(!this.disabled){this.doToggle();this.maybeShowMenu();this.fireHandler(a)}},fireHandler:function(a){var d=
this.handler;if(this.fire("click",[this,a])!==false){if(d)d.call(this.scope||this,this,a);this.blur()}},doToggle:function(){if(this.enableToggle&&(this.allowDepress!==false||!this.pressed))this.toggle();return this},onMouseOver_:function(a){if(!this.disabled&&!a.within(this.node,true,true))this.onMouseEnter_(a)},onMouseEnter_:function(a){this.addUiCls(this.overCls);this.fire("mouseover",[this,a])},onMouseOut_:function(a){if(!a.within(this.node,true,true)){if(this.overMenuTrigger)this.onMenuTriggerOut(a);
this.onMouseLeave_(a)}},onMouseLeave_:function(a){this.removeUiCls(this.overCls);this.fire("mouseout",[this,a])},onMouseDown_:function(a){!this.disabled&&a.button===0&&this.addUiCls(this.pressedCls)},onMouseUp_:function(a){if(a.button===0)this.pressed||this.removeUiCls(this.pressedCls)},onMouseMove_:function(a){var d=this.node,e=this.overMenuTrigger,b;if(this.split){if(this.arrowAlign==="right"){b=a.pageX-d.getX();d=d.width()}else{b=a.pageY-d.getY();d=d.height()}if(b>d-this.getTriggerSize()){if(!e)this.onMenuTriggerOver(a)}else if(e)this.onMenuTriggerOut(a)}},
getTriggerSize:function(){var a=this.triggerSize,d,e;if(a===void 0){a=this.node;e=this.childCt.btnWrap;d=this.arrowAlign;d=d.charAt(0);a=this.triggerSize=a.getPadding(d)+a.getBorderWidth(d)+e.getPadding(d)+e.getBorderWidth(d)}return a},onMenuShow:function(){this.ignoreNextClick=0;this.addUiCls(this.menuActiveCls);this.fire("menushow",[this,this.menu])},onMenuHide:function(){this.removeUiCls(this.menuActiveCls);this.ignoreNextClick=MT.func.delay(this.restoreClick,250,this);this.fire("menuhide",[this,
this.menu])},restoreClick:function(){this.ignoreNextClick=0},onMenuTriggerOver:function(a){this.overMenuTrigger=true;this.fire("menutriggerover",[this,this.menu,a])},onMenuTriggerOut:function(a){delete this.overMenuTrigger;this.fire("menutriggerout",[this,this.menu,a])},getLabel:function(){return this.label},setLabel:function(a){this.label=a;if(this.rendered){this.childCt.btnInnerEl.setHtml(a||"");this.setCompCls_()}return this},getFocusEl:function(){return this.getTargetEl()},setIconCls:function(a){var d=
this.childCt.btnIconEl,e=this.iconCls;this.iconCls=a;if(d){d.removeClass(e);d.addClass(a||"");this.setCompCls_()}return this},setIcon:function(a){var d=this.childCt.btnIconEl;this.icon=a;if(d){d.setStyle("background-image",a?"url("+a+")":"");this.setCompCls_()}return this},setHandler:function(a,d){this.handler=a;this.scope=d;return this},setTooltip:function(a){if(this.rendered)if(MT.isObject(a))this.tooltip=a;else this.childCt.btnEl.tag.setAttribute("title",a);else this.tooltip=a;return this},setTextAlign:function(a){var d=
this.childCt.btnEl;if(d){d.removeClass(this.baseCls+"-"+this.textAlign);d.addClass(this.baseCls+"-"+a)}this.textAlign=a;return this},toggle:function(a,d){a=a===undefined?!this.pressed:!!a;if(a!==this.pressed){if(this.rendered)this[a?"addUiCls":"removeUiCls"](this.pressedCls);this.pressed=a;if(!d){this.fire("toggle",[this,a]);if(this.toggleHandler)this.toggleHandler.call(this.scope||this,this,a)}}return this},maybeShowMenu:function(){this.menu&&!this.hasVisibleMenu()&&!this.ignoreNextClick&&this.showMenu()},
showMenu:function(){if(this.rendered&&this.menu){this.menu.isVisible()&&this.menu.hide();this.menu.showBy(this.node,this.menuAlign,!MT.Config.isStrict&&MT.ua.ie||MT.ua.ie6?[-2,-2]:undefined)}return this},hideMenu:function(){this.hasVisibleMenu()&&this.menu.hide();return this},hasVisibleMenu:function(){var a=this.menu;return a&&a.rendered&&a.isVisible()},enable:function(){this.callParent(arguments);this.removeUiCls("disabled");return this},disable:function(){this.callParent(arguments);this.addUiCls("disabled");
this.removeUiCls(this.overCls);return this},beforeDestroy:function(){this.menu&&this.destroyMenu!==false&&this.menu.destroy();this.callParent()},onDestroy:function(){this.rendered&&MT.BtnToggleMgr.unregister(this);this.callParent()}},function(){var a={},d=function(e,b){if(b){var f=a[e.toggleGroup],c=f.length,g;for(g=0;g<c;g++)f[g]!==e&&f[g].toggle(false)}};MT.BtnToggleMgr={register:function(e){if(e.toggleGroup){var b=a[e.toggleGroup];b||(b=a[e.toggleGroup]=[]);b.push(e);e.on("toggle",d)}},unregister:function(e){if(e.toggleGroup){var b=
a[e.toggleGroup];if(b){MT.array.remove(b,e);e.off("toggle",d)}}},getPressed:function(e){e=a[e];var b=0,f;if(e)for(f=e.length;b<f;b++)if(e[b].pressed===true)return e[b];return null}}});
MT.mtClass("MT.ui.SplitButton",{$extend:"MT.ui.Button",mType:"splitButton",arrowCls:"split",split:true,setArrowHandler:function(a,d){this.arrowHandler=a;this.scope=d},onClick_:function(a){a.preventDefault();if(!this.disabled)if(this.overMenuTrigger){this.maybeShowMenu();this.fire("arrowclick",[this,a]);if(this.arrowHandler)this.arrowHandler.call(this.scope||this,this,a)}else{this.doToggle();this.fireHandler(a)}}});
MT.mtClass("MT.ui.Tool",{$extend:"MT.ui.Component",baseCls:MT.cssPrefix+"tool",disabledCls:MT.cssPrefix+"tool-disabled",toolPressedCls:MT.cssPrefix+"tool-pressed",toolOverCls:MT.cssPrefix+"tool-over",mType:"tool",childEls:["toolEl"],width:15,height:15,haltEvent:true,renderTpl:'<img id="${id}-toolEl" src="${src}" class="${baseCls}-${type}" role="presentation"/>',initializer:function(){this.callParent(arguments);this.type=this.type||this.id;MT.mixin(this.renderData,{baseCls:this.baseCls,src:MT.BLANK_IMAGE_URL,
type:this.type,id:this.id});this.tooltip=this.tooltip||""},bindUI_:function(){var a=this.childCt.toolEl.tag,d=MT,e=d.func;d.on(a,"click",e.bind(this.onClick_,this));d.on(a,"mousedown",e.bind(this.onMouseDown_,this));d.on(a,"mouseover",e.bind(this.onMouseOver_,this));d.on(a,"mouseout",e.bind(this.onMouseOut_,this))},afterRender:function(){this.callParent(arguments);this.bindUI_();this.tooltip&&this.childCt.toolEl.tag.setAttribute("title",this.tooltip)},onClick_:function(a){var d,e;if(this.disabled)return false;
d=this.host;this.node.removeClass(this.toolPressedCls);this.node.removeClass(this.toolOverCls);this.haltEvent!==false&&a.halt();if((e=this.handler||this.click)&&MT.isFunction(e))e.call(this.scope||this,a,this.toolEl,d,this);return true},onMouseDown_:function(){if(this.disabled)return false;this.node.addClass(this.toolPressedCls)},onMouseOver_:function(){if(this.disabled)return false;this.node.addClass(this.toolOverCls)},onMouseOut_:function(){this.node.removeClass(this.toolOverCls)},getFocusEl:function(){return this.node},
setType:function(a){this.type=a;if(this.rendered)this.childCt.toolEl.tag.className=this.baseCls+"-"+a;return this}});
MT.mtClass("MT.ui.Header",{$extend:"MT.ui.Container",defType:"tool",isHeader:true,indicateDrag:false,baseCls:MT.cssPrefix+"panel-header",minHeight:15,childEls:["innerCt","textEl"],titleAlign:"left",renderTpl:['<div id="${id}-body" class="${baseCls}-body">','<div id="${id}-innerCt" class="${innerCls}">','<div id="${id}_hd"{#if titleAlign} style="text-align:${titleAlign}"{#/if}><span id="${id}-textEl" class="${baseCls}-text ${baseCls}-text-${ui}">${title}</span></div>',"</div>","</div>"],initializer:function(){this.callParent(arguments);
this.indicateDragCls=MT.cssPrefix+"widget-draggable";this.title=this.title||"";this.tools=this.tools||[];this.items=this.items||[];this.renderData={id:this.id,baseCls:this.baseCls,ui:this.ui,title:this.title,titleAlign:this.titleAlign,innerCls:this.innerCls}},afterRender:function(){var a=this;MT.dom.setUnselectable(a.node,true);a.indicateDrag&&a.addCls(a.indicateDragCls);a.node.on("click",MT.func.bind(a.onClick,a));MT.object.map(a.tools,function(d){a.wrapTool_(d)});a.items=a.items.concat(a.tools);
a.callParent()},onClick:function(a){var d=a.target;d&&!MT.string.contains(d.className,MT.cssPrefix+"tool")&&this.fire("click",[a,this])},setTitle:function(a){if(this.rendered)this.childCt.textEl.setHtml(a||"");this.title=a;return this},addTool:function(a){var d=this;if(MT.isArray(a)){a=MT.object.map(a,function(e){d.wrapTool_(e)});d.items=d.items.concat(a)}else{a=d.wrapTool_(a);d.items.push(a)}d.addComp(a);d.layout&&d.layout.doLayout();return d},getFocusEl:function(){return this.node},wrapTool_:function(a){a.mType=
"tool";a.renderTo=a.renderTo||this.childCt.innerCt;return a}});
MT.mtClass("MT.ui.Panel",{$extend:"MT.ui.Container",baseCls:MT.cssPrefix+"panel",mType:"panel",isPanel:true,childEls:["body"],border:true,closeable:false,closeAction:"destroy",noHeader:false,header:undefined,titleAlign:"left",layout:{hov:"v"},renderTpl:['<div id="${id}-body" class="${baseCls}-body ${baseCls}-body-${ui}{#if bodyCls} ${bodyCls}{#/if}"','{#if bodyStyle} style="${bodyStyle}"{#/if}>',"</div>"],initializer:function(){this.callParent(arguments)},initRenderData_:function(){return MT.mixin({id:this.id,
bodyCls:this.bodyCls,baseCls:this.baseCls,bodyStyle:this.bodyStyle,ui:this.ui},this.renderData)},addBodyCls:function(a){this.rendered&&this.childCt.body.addClass(a);return this},removeBodyCls:function(a){this.rendered&&this.childCt.body.removeClass(a);return this},getBody:function(){return this.childCt.body},setBodyStyle:function(a){this.rendered&&this.childCt.body.setStyle(a);return this},afterRender:function(){this.setHeader();this.closable&&this.addTool({type:"close",pack:"right",handler:MT.func.bind(this.close,
this,[])});this.addTools();this.bodyPadding!==undefined&&this.childCt.body.setStyle({padding:MT.dom.addUnits(this.bodyPadding)});this.callParent()},getTargetEl:function(){return this.childCt.body||this.node},getFocusEl:function(){return this.node},setHeader:function(){var a=this.header,d=this.title,e=this.tools;if(!this.noHeader&&(d||e&&e.length))if(a)a.show();else{a=this.header=new MT.ui.Header({parentComp:this,id:this.id+"_header",baseCls:this.baseCls+"-header",title:d,titleAlign:this.titleAlign,
tools:e,indicateDrag:this.draggable,renderPos:this.renderPos||0,dock:"top"});this.addChild(a)}else a&&a.hide()},setTitle:function(a){var d=this.header;d&&a&&d.setTitle(a);return this},close:function(){this.fire("beforeclose",this)!==false&&this.doClose()},doClose:function(){this.fire("close",this);this[this.closeAction]()},addTools:MT.noop,addTool:function(a){var d=this.header;d&&d.addTool(a);return this}});
MT.mtClass("MT.ui.Separator",{$extend:"MT.ui.Component",mType:"separator",isSeparator:true,baseCls:MT.cssPrefix+"toolbar-separator",minHeight:14,afterRender:function(){var a=this.parentComp;this.callParent();a.vertical?this.addUiCls("vertical"):this.addUiCls("horizontal")}});MT.mtClass("MT.ui.Spacer",{$extend:"MT.ui.Component",mType:"spacer",isSeparator:true,baseCls:MT.cssPrefix+"toolbar-spacer",afterRender:function(){var a=this.parentComp;this.callParent();a.vertical?this.addUiCls("vertical"):this.addUiCls("horizontal")}});
MT.mtClass("MT.ui.Textitem",{$extend:"MT.ui.Component",baseCls:MT.cssPrefix+"toolbar-text",text:"",mType:"textitem",renderTpl:"${text}",minHeight:16,beforeRender:function(){this.callParent();MT.mixin(this.renderData,{text:this.text},true)},setText:function(a){this.rendered&&this.node.html(a);this.text=a;return this}});
MT.mtClass("MT.ui.Toolbar",{$extend:"MT.ui.Container",isToolbar:true,mType:"toolbar",baseCls:MT.cssPrefix+"toolbar",itemCls:MT.cssPrefix+"toolbar-item",resetChildUi:true,vertical:false,childEls:["innerCt"],renderTpl:['<div id="${id}-innerCt" class="${innerCls}">',"</div>"],initializer:function(){this.callParent(arguments);if(this.vertical)this.layout={hov:"v"};this.dock=this.dock||"top";MT.mixin(this.renderData,{innerCls:this.innerCls})},afterRender:function(){this.mapItems();this.callParent();this.vertical&&
this.addUiCls("vertical");this.footer&&this.addUiCls("footer")},mapItems:function(){var a=this,d=a.items,e;a.getNode();var b=a.childCt.innerCt;a.items=MT.array.map(d,function(f){if(typeof f==="string"){e=f==="-"?{mType:"separator"}:f===" "?{mType:"spacer"}:{mType:"textitem",text:f};e.renderTo=b;if(a.vertical)e.pack=e.pack||"top";return e}f.renderTo=b;if(a.vertical)f.pack=f.pack||"top";return f})}});
MT.mtClass("MT.ui.Window",{$extend:"MT.ui.Panel",baseCls:MT.cssPrefix+"window",resizable:false,draggable:true,childEls:["body"],mType:"window",minimizable:false,maximizable:false,visible:false,closable:true,hideMode:"visibility",floating:true,isWindow:true,useProxy:true,initializer:function(){this.callParent(arguments)},afterRender:function(){var a,d,e=MT.cssPrefix,b=[],f=null,c=null;this.items&&MT.each(this.items,function(g){g.mType==="toolbar"&&g.bigBtn===true&&MT.each(g.items,function(h){if(h.mType===
"button"){h.scale="medium";h.minHeight=32;g.height=32}})});this.callParent();if(this.floating)this.node.on("mousedown",MT.func.bind(this.onMouseDown_,this));if(this.maximizable)this.header.getNode().on("dblclick",MT.func.bind(this.toggleMaximize,this));this.bindDD();a=this.getChildren();if(a.length){d=this.childCt.body;MT.each(a,function(g){if(g.visible&&g.mType==="toolbar"){d.addClass(e+"window-body-"+g.dock);if(g.dock=="top")f="top";if(g.dock=="bottom")c="bottom";if(g.dock=="left"||g.dock=="right")b.push(g)}else g.mType===
"toolbar"&&d.removeClass(e+"window-body-"+g.dock)});MT.each(b,function(g){var h=[];f&&h.push(e+"window-body-"+f);c&&h.push(e+"window-body-"+c);h.length&&g.node.addClass(h.join(" "))})}a=e+"widget-docked "+e+"widget-docked ";this.node.append('<div class="'+a+e+'window-lbdot"></div><div class="'+a+e+"window-lbdot "+e+'window-rbdot"></div>')},getFocusEl:function(){return this.node},onMouseDown_:function(){this.floating&&this.toFront(true)},bindDD:function(){var a=this,d=a.delegate&&a.delegate.dd,e=a.getNode();
if(!d)return false;d.addInvalid("img");d.on("drag:start",function(){e.setStyle("opacity:.5")},a);d.on("drag:drag",function(b){if(a.useProxy&&a.proxy){a.proxy.isVisible()||a.proxy.setStyle("zIndex:"+(e.getStyle("zIndex")+3)).show();a.proxy.setLeftTop(b.pageX,b.pageY)}else a.setPagePosition(b.pageX,b.pageY)},a);d.on("drag:end",function(b){a.proxy&&a.proxy.isVisible()&&a.proxy.hide();a.setPagePosition(b.pageX,b.pageY);e.setStyle("opacity:1")},a)},doClose:function(){if(this.visible)this.hide(this.animateTarget,
this.doClose,this);else{this.fire("close",this);this.closeAction=="destroy"&&this.destroy()}},addTools:function(){this.callParent();this.minimizable&&this.addTool({type:"minimize",pack:"right",handler:MT.func.bind(this.minimize,this,[])})},minimize:function(){this.fire("minimize",this);return this},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()}});
MT.mtClass("MT.ui.Tipbar",{$extend:"MT.ui.Component",isTipbar:true,mType:"tipbar",renderTo:MT.dom.getBody(),baseCls:MT.cssPrefix+"tipbar",innerCls:MT.cssPrefix+"tipmsg",succCls:MT.cssPrefix+"tipmsg-succ",errorCls:MT.cssPrefix+"tipmsg-error",visible:false,floating:true,msgTpl:['<div id="${id}" class="${innerCls}{#if succ} ${succCls}{#/if}{#if error} ${errorCls}{#/if}">',"<p>${msg}</p>","</div>"],initializer:function(){this.callParent(arguments);this.dockDom=this.dockDom?MT.get(this.dockDom):MT.dom.getDoc();
this.pos=this.pos||"t-t?";this.isTop=MT.string.contains(this.pos,"t");this.isBottom=MT.string.contains(this.pos,"b");this.msgCount=0},afterRender:function(){this.callParent();this.setPos().show()},addMsg:function(a){if(!(MT.isUndefined(a)||MT.isEmpty(a))){var d=this,e=MT,b;if(e.isArray(d.msgTpl)||e.isString(d.msgTpl))d.msgTpl=e.Template(d.msgTpl,d.id);e.isArray(a)||(a=[a]);d.visible||d.show();e.each(a,function(f){e.mixin(f,{id:e.guid("tmsg-"),innerCls:d.innerCls,succ:false,error:false,succCls:d.succCls,
errorCls:d.errorCls,msg:""});d.msgCount++;b=e.q(d.msgTpl.render(f));d.node[d.isBottom?"prepend":"append"](b);d.resetPos();f.notime||setTimeout(function(){b.fadeOut("normal",function(){b.remove();d.msgCount--;d.checkLen()})},e.number.parse(f.time,1E3))})}},resetPos:function(){this.isTop||this.setPos()},setPos:function(){this.setPagePosition(this.node.getAlignToXY(this.dockDom,this.pos));return this},checkLen:function(){this.msgCount<=0?this.hide():this.resetPos()}});
MT.add("MT.ui.tmsg",function(a){var d={};a.namespace("ui.tmsg");a.ui.tmsg=function(){var e=null,b="t-t?",f=300,c=arguments,g,h;if(c.length===0)return false;else if(c.length>1){e=c[0];h=c[1];if(a.isPlainObject(e)&&!e.key){b=e.pos||b;f=MT.number.parse(e.width,f);e=e.dockDom}}else h=c[0];e=e?a.get(e):a.dom.getDoc();g="tipbar"+e.key+b;(c=d[g])||(d[g]=c=new a.ui.Tipbar({dockDom:e,pos:b,width:f}));c.addMsg(h)}});
MT.mtClass("MT.ui.MsgBox",{$extend:"MT.ui.Window",mType:"msgBox",YES:1,NO:2,OK:4,CANCEL:8,YESNO:3,OKCANCEL:12,YESNOCANCEL:11,INFO:MT.cssPrefix+"msgbox-info",WARNING:MT.cssPrefix+"msgbox-warning",QUESTION:MT.cssPrefix+"msgbox-question",ERROR:MT.cssPrefix+"msgbox-error",cls:MT.cssPrefix+"msgbox",modal:true,hideMode:"display",closeAction:"hide",useProxy:false,resizable:false,title:"&#160;",width:300,height:180,minWidth:180,maxWidth:600,minHeight:110,maxHeight:500,constrain:true,btnIds:["yes","no","ok",
"cancel"],noIcon:false,btnTxt:{yes:" \u662f  ",no:" \u5426 ",ok:"\u786e  \u5b9a",cancel:"\u53d6  \u6d88"},titleTxt:{wait:"Loading...",alert:"\u63d0\u793a",confirm:"\u786e\u5b9a",prompt:"Prompt"},msgArea:['<table cellspacing="2" id="${id}-msgBody" class="${msgCt}">',"<tbody>",'<tr valign="top">','<td class="{#if !noIcon} ${iconCls}{#/if}"><div id="${id}-iconEl" class="${iconCls} ${icon}{#if noIcon} ${hideIcon}{#/if}"></div></td>',"<td>",'<div id="${id}-msgEl">${msg}</div>',"{#if prompt}",'<div style="margin-top:5px;">{#if multiline}<textarea id="${id}-textareaEl" name="${id}-textareaEl" style="width:90%;height:75px;" class="${inputField} ${inputCls}" autocomplete="off" aria-invalid="false">${inptVal}</textarea>{#else}<input type="text" id="${id}-inputEl" name="${id}-inputEl" style="width:90%;" class="${inputField} ${inputCls}" size="1" autocomplete="off" aria-invalid="false" value="${inptVal}" />{#/if}</div>',
"{#/if}","</td>","</tr>","</tbody>","</table>"],initializer:function(){this.callParent(arguments);this.ddConfig=this.ddConfig||{};MT.mixin(this.ddConfig,{constrainCfg:{constrain2view:1,gutter:"5 5 5 5"}})},afterRender:function(){var a,d=[],e=this.id;for(a=0;a<4;a++)d.push(this.mapButton(a));this.items=[{id:e+"-toolbar",mType:"toolbar",dock:"bottom",height:22,items:d}];this.callParent();if(!this.msgTpl)this.msgTpl=MT.Template(this.msgArea);this.msgButtons=[];for(a=0;a<4;a++){d=MT.CompMgr.get(e+"-"+
this.btnIds[a]);this.msgButtons[d.itemId]=d;this.msgButtons.push(d)}this.bottomTb=MT.CompMgr.get(e+"-toolbar");this.on("close",this.onClose,this)},onClose:function(){var a=this.header.node;a.itemId="cancel";this.btnCallback(a);delete a.itemId},mapButton:function(a){a=this.btnIds[a];return{id:this.id+"-"+a,mType:"button",pack:"center",handler:this.btnCallback,itemId:a,scope:this,label:this.btnTxt[a],minWidth:60}},btnCallback:function(a){var d,e;if(this.cfg.prompt||this.cfg.multiline){e=this.cfg.multiline?
this.textArea:this.textField;e=MT.getDom(e);d=e.value;e.value=""}a.blur();this.hide();this.userCallback(a.itemId,d,this.cfg)},reCfg:function(a){a=a||{};var d=this.btnTxt,e=0,b=true;e=MT.cssPrefix;var f={};this.setBtnLabel();this.msg&&MT.removeNode(this.msg);this.cfg=a;MT.mixin(f,{id:this.id,msgCt:e+"msgbox-msg",iconCls:e+"msgbox-icon",icon:a.icon||"",noIcon:!a.icon||a.icon==="",hideIcon:e+"hidden-display",msg:a.msg||"",prompt:a.prompt,multiline:a.multiline,inputField:e+"form-field",inputCls:e+"form-text",
inptVal:a.value||""});this.childCt.body.setHtml(this.msgTpl.render(f));this.modal=a.modal!==false;if(a.title)this.setTitle(a.title||"&#160;");if(MT.isObject(a.buttons)){this.btnTxt=a.buttons;e=0}else{this.btnTxt=a.buttonText||this.btnTxt;e=MT.isNumber(a.buttons)?a.buttons:0}e|=this.setBtnLabel();this.btnTxt=d;this.visible=true;this.setSize(a.width,a.height);this.closable=a.closable&&!a.wait;d=MT.q(this.header.node.tag).find("."+MT.cssPrefix+"tool-close");if(d[0]){d=MT.get(d[0].parentNode);d.setVisible_(a.closable!==
false)}!a.title&&!this.closable?this.header.hide():this.header.show();this.userCallback=MT.func.bind(a.callback||a.fn||MT.noop,a.scope||MT.global);this.setIcon(a.icon);d=MT.getDom(this.id+"-msgEl");if(a.msg){this.setMsg(a.msg);d.style.display=""}else d.style.display="none";if(a.prompt||a.multiline)if(a.multiline)this.textArea=MT.getDom(this.id+"-textareaEl");else this.textField=MT.getDom(this.id+"-inputEl");for(a=0;a<4;a++)if(e&Math.pow(2,a)){this.msgButtons[a].show();b=false}else this.msgButtons[a].hide();
if(b)this.bottomTb.hide();else{this.bottomTb.layout.reLayout();this.bottomTb.show()}this.layout.reLayout()},setBtnLabel:function(){var a=this.btnTxt,d=0,e,b;for(e in a)if(a.hasOwnProperty(e))if(b=this.msgButtons[e]){if(this.cfg&&this.cfg.buttonText)d|=Math.pow(2,MT.array.indexOf(this.btnIds,e));b.label!=a[e]&&b.setLabel(a[e])}return d},setIcon:function(a){var d=MT.getDom(this.id+"-iconEl");if(a)d.className=MT.cssPrefix+"msgbox-icon "+a;return this},setMsg:function(a){var d=MT.getDom(this.id+"-msgEl");
if(a)d.innerHTML=a;return this},show:function(a){var d=this.childCt.body;this.reCfg(a);this.visible=false;this.callParent();(this.msg=MT.get(this.id+"-msgBody"))&&this.msg.center(d);return this},onShow:function(){var a=this.cfg;this.callParent(arguments);a&&a.alignTo?this.alignTo(MT.get(a.alignTo),a.alignPos||"c-c?"):this.center()},wait:function(){},alert:function(a,d,e,b){if(MT.isString(a))a={title:a,msg:d,buttons:this.OK,fn:e,scope:b,minWidth:this.minWidth};return this.show(a)},confirm:function(a,
d,e,b){if(MT.isString(a))a={title:a,icon:this.QUESTION,msg:d,buttons:this.YESNO,callback:e,scope:b};return this.show(a)},prompt:function(a,d,e,b,f,c){if(MT.isString(a))a={title:a,msg:d,buttons:this.OKCANCEL,callback:e,scope:b,multiline:f,value:c};a.prompt=true;return this.show(a)}},function(){MT.ready(function(){MT.MsgBox=new MT.ui.MsgBox({renderTo:MT.dom.getBody()})})});
